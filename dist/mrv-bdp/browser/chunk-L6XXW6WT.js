import{a as de,b as Lt}from"./chunk-C5UTVSEF.js";import"./chunk-FK6H3RFT.js";import{a as Se}from"./chunk-OHGPZTAV.js";import{a as Ce}from"./chunk-GYVQKG2A.js";import{a as ye}from"./chunk-FC5ZCP22.js";import{a as kt,b as Vt}from"./chunk-DOPYPM73.js";import{a as Pt,b as Rt}from"./chunk-CK5U46UF.js";import{a as Ee}from"./chunk-XC25IVD2.js";import{a as bt}from"./chunk-RWZV4OPL.js";import{a as vt,b as Et,c as Ct,d as yt,e as St,f as xt,g as Ft,h as It,i as wt,j as Mt,k as Dt,l as Tt,n as Ue,o as Nt,p as Bt,q as Ot}from"./chunk-XBSZIRZA.js";import{a as qt,b as At}from"./chunk-JN3ATQ65.js";import{a as Re}from"./chunk-IXGIIPBD.js";import{a as pt,b as z,c as f,e as K,f as oe,h as m,i as gt,j as ie,k as ne,l as _t,m as ae,p as re,q as he,r as be,s as ve,t as le,u as ft,v as se,w as ht,x as Q}from"./chunk-B4EPVZF2.js";import"./chunk-IX6G3U3V.js";import"./chunk-35W2KPSY.js";import{a as ut}from"./chunk-OGI2M7DR.js";import{k as te,l as fe,m as $,o as Je,p as H}from"./chunk-6XSUGG7T.js";import{$ as E,$b as j,Ab as g,Bb as Z,Cb as ee,Eb as ue,Jb as b,Kb as U,Ob as nt,Pb as at,Qa as ot,Qb as rt,Ta as it,Ub as r,V as et,Va as l,Wa as P,Wb as T,Xb as lt,Yb as st,Zb as dt,_b as ct,ac as mt,bc as h,da as R,gb as Pe,ja as tt,la as G,ma as J,mb as u,na as Y,oa as Qe,ob as s,pa as Xe,ua as W,yb as i,zb as o}from"./chunk-XFA5AQSA.js";import"./chunk-TSRGIXR5.js";var V=class a{ecoeficiencias=Pe([]);_http=E(ut);_endPoint=ht.apiUrl;_injector=E(tt);crearEcoeficiencia(t){return console.log(t),this._http.post(`${this._endPoint}/eco`,t)}getEcoeficiencia(){return this._http.get(`${this._endPoint}/eco`)}getEcoeficienciaById(t){return console.log(t),this._http.get(`${this._endPoint}/eco/`+t)}eliminaEcoeficiencia(t){return this._http.delete(`${this._endPoint}/eco/`+t)}static \u0275fac=function(n){return new(n||a)};static \u0275prov=et({token:a,factory:a.\u0275fac,providedIn:"root"})};var ce=a=>({"border-red-500":a});function Ut(a,t){if(a&1&&(i(0,"option",26),r(1),o()),a&2){let n=t.$implicit;s("value",n.value),l(),T(" ",n.name," ")}}function jt(a,t){a&1&&(i(0,"div",27),r(1," * "),o())}function Ht(a,t){a&1&&(i(0,"div",27),r(1," * "),o())}function Gt(a,t){if(a&1&&(i(0,"option",26),r(1),o()),a&2){let n=t.$implicit;s("value",n.value),l(),T(" ",n.name," ")}}function Wt(a,t){a&1&&(i(0,"div",27),r(1," * "),o())}function $t(a,t){a&1&&(i(0,"div",27),r(1," * "),o())}function zt(a,t){if(a&1&&(i(0,"option",26),r(1),o()),a&2){let n=t.$implicit;s("value",n.value),l(),T(" ",n.name," ")}}function Kt(a,t){a&1&&(i(0,"div",27),r(1," * "),o())}function Qt(a,t){a&1&&(i(0,"div",27),r(1," * "),o())}function Xt(a,t){a&1&&(i(0,"div",27),r(1," * "),o())}function Jt(a,t){a&1&&(i(0,"div",27),r(1," * "),o())}var je=class a{constructor(t,n){this.fb=t;this.regService=n;this.dataForm=this.fb.group({usuarioId:new m(0),regionId:new m(0),agenciaId:new m(0),nro_solicitud:new m(""),caedecId:new m(0),respaldo:new m(""),subcategoriaId:new m(0),inversionElegibleId:new m(0),monto_inv_mn:new m(0),monto_inv_me:new m(0),produccion_energia_anual:new m(0),reduccion_emisiones_anual:new m(0),potencia_inst_sis:new m(0),vida_util:new m(0),region_inst:new m("",[f.required]),ren_esp_sis:new m({value:"",disabled:!0},[f.required]),vida_util_c:new m({value:"",disabled:!0},[f.required]),tipo_sistema:new m("",[f.required]),tipo_combustible:new m("",[f.required]),pot_inst_sis:new m({value:"",disabled:!0},[f.required]),pro_anual_ener:new m({value:"",disabled:!0},[f.required]),aho_ener_total:new m({value:"",disabled:!0},[f.required]),red_emi_anu:new m({value:"",disabled:!0},[f.required]),red_emi_total:new m({value:"",disabled:!0},[f.required])})}dataOds=null;montoInvMe;regionId;agenciaId;nroSolicitud;caedecId;respaldo;subcategoriaId;inversionElegibleId;MontoInvBS;onCloseModalEbFv=new W;data=null;lbVidaUtil=[];lbPotInsSis=[];lbTipoSistema;proAnualEner=null;ahoEnerTotal=null;toastr=E(Q);regInstService=E(Se);lbService=E(Ce);pftService=E(ye);ecoService=E(V);dataForm;regionesInstList=[];tipoSistemaList=[];tipoCombustibleList=[];authService=E(Ee);odsService=E(de);montoMe=0;ngOnChanges(){this.montoInvMe&&(this.montoMe=this.montoInvMe),this.authService.userId$.subscribe(t=>{this.dataForm.patchValue({usuarioId:parseInt(t[0])})})}ngOnInit(){this.getRegionesInstalacion(),this.getTipoSistema(),this.getTipoCombustible()}getTipoCombustible(){this.pftService.getPrecioFactorTasa().subscribe({next:t=>{let n=t.filter(e=>e.tipo==="FE_KGCO2KWH_E"||e.tipo==="FE_KGCO2LT_D"||e.tipo==="FE_KGCO2LT_G");this.tipoCombustibleList=n.map(e=>({value:e.id,name:e.descripcion,valor:e.valor,unidad:e.unidad}))},error:()=>{this.toastr.error("Error al cargar los datos")}})}getTipoSistema(){this.lbService.getLineaBase().subscribe({next:t=>{let n=t.filter(e=>e.proyecto==="EBFV_AB"||e.proyecto==="EBFV_GD");console.log(n),this.tipoSistemaList=n.map(e=>({value:e.id,name:e.tipo_tecnologia,medida:e.medida,unidad:e.unidad_medida}))},error:()=>{this.toastr.error("Error al cargar los datos")}})}getRegionesInstalacion(){this.regInstService.getRegionesInstalacion().subscribe({next:t=>{this.regionesInstList=t.map(n=>({value:n.id,name:n.region,pvout:n.pvout}))},error:t=>{console.error("Error al cargar regiones:",t)}})}getLineaBase(){this.lbService.getLineaBase().subscribe({next:t=>{this.lbVidaUtil=t,this.lbPotInsSis=t,this.lbTipoSistema=t;let n=this.lbVidaUtil.filter(d=>d.proyecto==="EBFV_GSEA"),e=n.length>0?n[0].medida:null;this.dataForm.get("vida_util_c")?.setValue(e,{emitEvent:!1})},error:()=>{this.toastr.error("Error al cargar los datos")}})}ecoId;onSubmit(){this.dataForm.valid?this.data||(this.dataForm.patchValue({regionId:this.regionId,agenciaId:this.agenciaId,nro_solicitud:this.nroSolicitud,respaldo:this.respaldo,caedecId:this.caedecId,subcategoriaId:this.subcategoriaId,inversionElegibleId:this.inversionElegibleId,monto_inv_mn:this.MontoInvBS,monto_inv_me:this.montoInvMe,produccion_energia_anual:this.dataForm.get("pro_anual_ener")?.value,reduccion_emisiones_anual:this.dataForm.get("red_emi_anu")?.value,potencia_inst_sis:this.dataForm.get("pot_inst_sis")?.value,vida_util:this.dataForm.get("vida_util_c")?.value}),this.ecoService.crearEcoeficiencia(this.dataForm.value).subscribe({next:t=>{this.resetdataForm(),this.toastr.success("Ecoeficiencia registrada con exito!"),this.dataOds.ecoId=t,console.log(this.dataOds),this.odsService.crearOds(this.dataOds).subscribe({next:()=>{this.toastr.success("Ods registrados")}})},error:t=>{console.error("Error al actualizar Ecoeficiencia:",t),this.toastr.error("No se pudo registrar Ecoeficiencia. Int\xE9ntelo nuevamente m\xE1s tarde.")}})):this.dataForm.markAllAsTouched()}onRegionChange(t){let e=t.target.value,d=this.regionesInstList.find(c=>c.value===+e);d&&this.dataForm.get("ren_esp_sis")?.setValue(d.pvout,{emitEvent:!1}),this.getLineaBase()}selectedMedida=0;onTipoSistemaChange(t){let e=t.target.value,d=this.tipoSistemaList.find(S=>S.value===+e);d?(this.selectedMedida=d.medida,this.montoMe,this.dataForm.get("pot_inst_sis")?.setValue((this.montoMe/this.selectedMedida).toFixed(1),{emitEvent:!1})):this.selectedMedida=0;let c=this.dataForm.get("pot_inst_sis")?.value,_=this.dataForm.get("ren_esp_sis")?.value;c&&_?(this.proAnualEner=c*_,this.dataForm.get("pro_anual_ener")?.setValue((this.montoMe/this.selectedMedida*_).toFixed(0),{emitEvent:!1})):this.proAnualEner=null;let p=this.dataForm.get("pro_anual_ener")?.value,v=this.dataForm.get("vida_util_c")?.value;p&&v?(this.ahoEnerTotal=p*v,this.dataForm.get("aho_ener_total")?.setValue(this.ahoEnerTotal,{emitEvent:!1})):this.ahoEnerTotal=null}selectedValor=0;onTipoEnergiaChange(t){let e=t.target.value,d=this.dataForm.get("pro_anual_ener")?.value,c=this.tipoCombustibleList.find(v=>v.value===+e);if(c)switch(this.selectedValor=c.valor,c?.name){case"Electricidad":this.dataForm.get("red_emi_anu")?.setValue((d*c.valor).toFixed(0),{emitEvent:!1});break;case"Diesel":this.dataForm.get("red_emi_anu")?.setValue((d*(c.valor/10.03)*(1/.35)).toFixed(0),{emitEvent:!1});break;case"Gasolina":this.dataForm.get("red_emi_anu")?.setValue((d*(c.valor/9.11)*(1/.35)).toFixed(0),{emitEvent:!1});break}else this.selectedValor=0;let _=this.dataForm.get("red_emi_anu")?.value,p=this.dataForm.get("vida_util_c")?.value;this.dataForm.get("red_emi_total")?.setValue(p*_,{emitEvent:!1})}resetdataForm(){this.dataForm.reset(),this.onClose()}onClose(){this.onCloseModalEbFv.emit(!1),this.dataForm.reset({region_inst:"",tipo_sistema:"",tipo_combustible:""})}static \u0275fac=function(n){return new(n||a)(P(le),P(Se))};static \u0275cmp=R({type:a,selectors:[["app-eb-fv"]],inputs:{dataOds:"dataOds",montoInvMe:"montoInvMe",regionId:"regionId",agenciaId:"agenciaId",nroSolicitud:"nroSolicitud",caedecId:"caedecId",respaldo:"respaldo",subcategoriaId:"subcategoriaId",inversionElegibleId:"inversionElegibleId",MontoInvBS:"MontoInvBS",data:"data"},outputs:{onCloseModalEbFv:"onCloseModalEbFv"},standalone:!0,features:[G,j],decls:58,vars:36,consts:[[1,"mb-5","text-lg","font-bold","tracking-tight","text-gray-900","dark:text-white"],[1,"w-full",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-4"],[1,"relative","mt-6","flex","items-center"],["id","region_inst","formControlName","region_inst","autocomplete","NA",1,"peer","mt-1","w-96","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"change","ngClass"],["value","","selected",""],[3,"value",4,"ngFor","ngForOf"],["for","region_inst",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["class","absolute -right-4 text-red-500",4,"ngIf"],["type","number","name","ren_esp_sis","id","ren_esp_sis","placeholder","ren_esp_sis","formControlName","ren_esp_sis","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","ren_esp_sis",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["id","tipo_sistema","formControlName","tipo_sistema","autocomplete","NA",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"change","ngClass"],["for","tipo_sistema",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","vida_util","name","vida_util_c","id","vida_util","placeholder","vida_util_c","formControlName","vida_util_c","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","vida_util_c",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["id","tipo_combustible","formControlName","tipo_combustible","autocomplete","NA",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"change","ngClass"],["for","tipo_combustible",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","pot_inst_sis","name","pot_inst_sis","id","pot_inst_sis","placeholder","pot_inst_sis","formControlName","pot_inst_sis","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","pot_inst_sis",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","pro_anual_ener","name","pro_anual_ener","id","pro_anual_ener","placeholder","pro_anual_ener","formControlName","pro_anual_ener","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","pro_anual_ener",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","red_emi_anu","name","aho_ener_anual","id","red_emi_anu","placeholder","red_emi_anu","formControlName","red_emi_anu","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","red_emi_anu",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],[1,"my-5"],["type","submit",1,"text-white","bg-blue-600","hover:bg-blue-700","font-medium","rounded-lg","w-full","sm:w-auto","px-5","py-2.5","text-center"],["type","button",1,"text-white","ms-2","bg-gray-700","hover:bg-gray-800","font-medium","rounded-lg","w-full","sm:w-auto","px-5","py-2.5","text-center",3,"click"],[3,"value"],[1,"absolute","-right-4","text-red-500"]],template:function(n,e){if(n&1&&(i(0,"h5",0),r(1,"Ingresar datos para Desarrollo de Proyecto EB-FV"),o(),i(2,"form",1),b("ngSubmit",function(){return e.onSubmit()}),i(3,"div",2)(4,"div",3)(5,"select",4),b("change",function(c){return e.onRegionChange(c)}),i(6,"option",5),r(7,"Seleccione Region de Instalacion"),o(),u(8,Ut,2,2,"option",6),o(),i(9,"label",7),r(10," Region de Instalaci\xF3n "),o(),u(11,jt,2,0,"div",8),o(),i(12,"div",3),g(13,"input",9),i(14,"label",10),r(15," R.E.S. (kWh/kWp)"),o(),u(16,Ht,2,0,"div",8),o(),i(17,"div",3)(18,"select",11),b("change",function(c){return e.onTipoSistemaChange(c)}),i(19,"option",5),r(20,"Seleccione tipo sistema"),o(),u(21,Gt,2,2,"option",6),o(),i(22,"label",12),r(23," Tipo sistema "),o(),u(24,Wt,2,0,"div",8),o(),i(25,"div",3),g(26,"input",13),i(27,"label",14),r(28," vida_util (A\xF1os) "),o(),u(29,$t,2,0,"div",8),o(),i(30,"div",3)(31,"select",15),b("change",function(c){return e.onTipoEnergiaChange(c)}),i(32,"option",5),r(33,"Seleccione linea base"),o(),u(34,zt,2,2,"option",6),o(),i(35,"label",16),r(36," Linea Base "),o(),u(37,Kt,2,0,"div",8),o(),i(38,"div",3),g(39,"input",17),i(40,"label",18),r(41," Potencia Instalada de Sistema(kWp) "),o(),u(42,Qt,2,0,"div",8),o(),i(43,"div",3),g(44,"input",19),i(45,"label",20),r(46," Produccion Anual Energia(kWh/a\xF1o) "),o(),u(47,Xt,2,0,"div",8),o(),i(48,"div",3),g(49,"input",21),i(50,"label",22),r(51," Reduccion Emisiones. Anual.(kg CO2/a\xF1o)"),o(),u(52,Jt,2,0,"div",8),o()(),i(53,"div",23)(54,"button",24),r(55,"Confirmar"),o(),i(56,"button",25),b("click",function(){return e.onClose()}),r(57,"Cancel"),o()()()),n&2){let d,c,_,p,v,S,I,C,w,M,N,B,x,D,y,F;l(2),s("formGroup",e.dataForm),l(3),s("ngClass",h(20,ce,((d=e.dataForm.get("region_inst"))==null?null:d.hasError("required"))&&((d=e.dataForm.get("region_inst"))==null?null:d.touched))),l(3),s("ngForOf",e.regionesInstList),l(3),s("ngIf",((c=e.dataForm.get("region_inst"))==null?null:c.hasError("required"))&&((c=e.dataForm.get("region_inst"))==null?null:c.touched)),l(2),s("ngClass",h(22,ce,((_=e.dataForm.get("ren_esp_sis"))==null?null:_.hasError("required"))&&((_=e.dataForm.get("ren_esp_sis"))==null?null:_.touched))),l(3),s("ngIf",((p=e.dataForm.get("ren_esp_sis"))==null?null:p.hasError("required"))&&((p=e.dataForm.get("ren_esp_sis"))==null?null:p.touched)),l(2),s("ngClass",h(24,ce,((v=e.dataForm.get("tipo_sistema"))==null?null:v.hasError("required"))&&((v=e.dataForm.get("tipo_sistema"))==null?null:v.touched))),l(3),s("ngForOf",e.tipoSistemaList),l(3),s("ngIf",((S=e.dataForm.get("tipo_sistema"))==null?null:S.hasError("required"))&&((S=e.dataForm.get("tipo_sistema"))==null?null:S.touched)),l(2),s("ngClass",h(26,ce,((I=e.dataForm.get("vida_util_c"))==null?null:I.hasError("required"))&&((I=e.dataForm.get("vida_util_c"))==null?null:I.touched))),l(3),s("ngIf",((C=e.dataForm.get("vida_util_c"))==null?null:C.hasError("required"))&&((C=e.dataForm.get("vida_util_c"))==null?null:C.touched)),l(2),s("ngClass",h(28,ce,((w=e.dataForm.get("tipo_combustible"))==null?null:w.hasError("required"))&&((w=e.dataForm.get("tipo_combustible"))==null?null:w.touched))),l(3),s("ngForOf",e.tipoCombustibleList),l(3),s("ngIf",((M=e.dataForm.get("tipo_combustible"))==null?null:M.hasError("required"))&&((M=e.dataForm.get("tipo_combustible"))==null?null:M.touched)),l(2),s("ngClass",h(30,ce,((N=e.dataForm.get("pot_inst_sis"))==null?null:N.hasError("required"))&&((N=e.dataForm.get("pot_inst_sis"))==null?null:N.touched))),l(3),s("ngIf",((B=e.dataForm.get("pot_inst_sis"))==null?null:B.hasError("required"))&&((B=e.dataForm.get("pot_inst_sis"))==null?null:B.touched)),l(2),s("ngClass",h(32,ce,((x=e.dataForm.get("pro_anual_ener"))==null?null:x.hasError("required"))&&((x=e.dataForm.get("pro_anual_ener"))==null?null:x.touched))),l(3),s("ngIf",((D=e.dataForm.get("pro_anual_ener"))==null?null:D.hasError("required"))&&((D=e.dataForm.get("pro_anual_ener"))==null?null:D.touched)),l(2),s("ngClass",h(34,ce,((y=e.dataForm.get("red_emi_anu"))==null?null:y.hasError("required"))&&((y=e.dataForm.get("red_emi_anu"))==null?null:y.touched))),l(3),s("ngIf",((F=e.dataForm.get("red_emi_anu"))==null?null:F.hasError("required"))&&((F=e.dataForm.get("red_emi_anu"))==null?null:F.touched))}},dependencies:[H,te,fe,$,se,ie,be,ve,z,ne,he,K,oe,ae,re]})};var me=a=>({"border-red-500":a});function Yt(a,t){a&1&&(i(0,"div",23),r(1," * "),o())}function Zt(a,t){a&1&&(i(0,"div",23),r(1," * "),o())}function eo(a,t){a&1&&(i(0,"div",23),r(1," * "),o())}function to(a,t){a&1&&(i(0,"div",23),r(1," * "),o())}function oo(a,t){a&1&&(i(0,"div",23),r(1," * "),o())}function io(a,t){a&1&&(i(0,"div",23),r(1," * "),o())}function no(a,t){a&1&&(i(0,"div",23),r(1," * "),o())}function ao(a,t){a&1&&(i(0,"div",23),r(1," * "),o())}var We=class a{constructor(t,n){this.fb=t;this.ecoService=n;this.dataForm=this.fb.group({usuarioId:new m(0),regionId:new m(0),agenciaId:new m(0),nro_solicitud:new m(""),caedecId:new m(0),respaldo:new m(""),subcategoriaId:new m(0),inversionElegibleId:new m(0),monto_inv_mn:new m(0),monto_inv_me:new m(0),produccion_energia_anual:new m(0),reduccion_emisiones_anual:new m(0),potencia_inst_sis:new m(0),vida_util:new m(0),pot_nomi_bom:new m({value:"",disabled:!0},[f.required]),unidades:new m({value:"",disabled:!0},[f.required]),con_elec_total:new m({value:"",disabled:!0},[f.required]),pre_equi_ins:new m({value:"",disabled:!0},[f.required]),hrs_ope_anual:new m({value:"",disabled:!0},[f.required]),vida_util_c:new m({value:"",disabled:!0},[f.required]),aho_ene_total:new m({value:"",disabled:!0},[f.required]),red_emi_anual:new m({value:"",disabled:!0},[f.required])})}dataOds=null;montoInvMe;regionId;agenciaId;nroSolicitud;caedecId;respaldo;subcategoriaId;inversionElegibleId;MontoInvBS;data=null;onCloseModalEbSb=new W;lbService=E(Ce);pftService=E(ye);toastr=E(Q);lbPotencia=[];lbCostoUniW=[];lbCostoPorcentual=[];lbConElecTot=[];lbVidaUtil=[];factoEmisionKwh=[];selectedCostoUnitario;authService=E(Ee);odsService=E(de);potenciaNominalBomba;dataForm;montoMe=0;ngOnChanges(t){t.montoInvMe&&this.montoInvMe&&(this.montoMe=this.montoInvMe,console.log(this.montoMe),this.getPotenciaNominalBomba())}ngOnInit(){this.authService.userId$.subscribe(t=>{console.log("El id de usuario es  :",t),this.dataForm.patchValue({usuarioId:parseInt(t[0])})})}getPrecioEquipoMasInstalacion(){this.lbService.getLineaBase().subscribe({next:t=>{this.lbCostoUniW=t;let n=this.lbCostoUniW.filter(e=>e.proyecto==="EBSB_CUKWP");this.selectedCostoUnitario=n[0].medida,console.log(this.selectedCostoUnitario)}}),this.pftService.getPrecioFactorTasa().subscribe({next:t=>{this.lbCostoPorcentual=t;let n=this.lbCostoPorcentual.filter(d=>d.tipo==="EBSB_COS_INTS"),e=this.dataForm.get("pot_nomi_bom")?.value;this.dataForm.get("pre_equi_ins")?.setValue(this.selectedCostoUnitario*(1+n[0].valor/100)*(e*1e3),{emitEvent:!1})}})}getConsumoElectricidadTotal(){this.lbService.getLineaBase().subscribe({next:t=>{console.log(t),this.lbConElecTot=t;let e=this.lbConElecTot.filter(_=>_.proyecto==="EBSB_CET")[0].medida,d=this.dataForm.get("pot_nomi_bom")?.value,c=this.dataForm.get("unidades")?.value;this.dataForm.get("con_elec_total")?.setValue(e*d*c,{emitEvent:!1}),this.dataForm.get("hrs_ope_anual")?.setValue(e,{emitEvent:!1})}})}getPotenciaNominalBomba(){this.lbService.getLineaBase().subscribe({next:t=>{this.lbPotencia=t;let n=this.lbPotencia.filter(e=>e.proyecto.trim()==="EBSB_PER");this.potenciaNominalBomba=n[0].medida,this.dataForm.get("pot_nomi_bom")?.setValue(this.potenciaNominalBomba,{emitEvent:!1})}}),this.lbService.getLineaBase().subscribe({next:t=>{this.lbCostoUniW=t;let n=this.lbCostoUniW.filter(e=>e.proyecto==="EBSB_CUKWP");this.selectedCostoUnitario=n[0].medida,console.log(this.selectedCostoUnitario),this.pftService.getPrecioFactorTasa().subscribe({next:e=>{this.lbCostoPorcentual=e;let d=this.lbCostoPorcentual.filter(p=>p.tipo==="EBSB_COS_INTS");console.log(d);let c=parseFloat(this.dataForm.get("pot_nomi_bom")?.value),_=d[0].valor;console.log(_),console.log(this.potenciaNominalBomba),console.log(this.montoMe),console.log(this.selectedCostoUnitario),console.log(1+_/100),console.log(this.montoMe*(1/(this.selectedCostoUnitario*(1+_/100)))/1e3),this.dataForm.get("unidades")?.setValue(Math.floor(this.montoMe*(1/(this.selectedCostoUnitario*(1+_/100)))/1e3/this.potenciaNominalBomba),{emitEvent:!1}),this.lbService.getLineaBase().subscribe({next:p=>{console.log(p),this.lbConElecTot=p;let S=this.lbConElecTot.filter(I=>I.proyecto==="EBSB_CET")[0].medida;this.dataForm.get("con_elec_total")?.setValue(S*this.potenciaNominalBomba*Math.floor(this.montoMe*(1/(this.selectedCostoUnitario*(1+_/100)))/1e3/this.potenciaNominalBomba),{emitEvent:!1}),this.dataForm.get("hrs_ope_anual")?.setValue(S,{emitEvent:!1}),this.lbService.getLineaBase().subscribe({next:I=>{this.lbVidaUtil=I;let C=this.lbVidaUtil.filter(M=>M.proyecto==="EBSB_VUT"),w=C.length>0?C[0].medida:null;this.dataForm.get("vida_util_c")?.setValue(w,{emitEvent:!1}),this.dataForm.get("aho_ene_total")?.setValue(S*this.potenciaNominalBomba*Math.floor(this.montoMe*(1/(this.selectedCostoUnitario*(1+_/100)))/1e3/this.potenciaNominalBomba)*C[0].medida,{emitEvent:!1})}}),this.pftService.getPrecioFactorTasa().subscribe({next:I=>{this.factoEmisionKwh=I;let w=this.factoEmisionKwh.filter(M=>M.tipo==="EBSB_FE_KW")[0].valor;this.dataForm.get("red_emi_anual")?.setValue((S*this.potenciaNominalBomba*Math.floor(this.montoMe*(1/(this.selectedCostoUnitario*(1+_/100)))/1e3/this.potenciaNominalBomba)*w).toFixed(0),{emitEvent:!1})}})}}),this.pftService.getPrecioFactorTasa().subscribe({next:p=>{this.lbCostoPorcentual=p;let v=this.lbCostoPorcentual.filter(S=>S.tipo==="EBSB_COS_INTS");this.dataForm.get("pre_equi_ins")?.setValue(this.selectedCostoUnitario*(1+v[0].valor/100)*(this.potenciaNominalBomba*1e3),{emitEvent:!1})}})}})}})}onSubmit(){console.log(this.dataForm.value),this.dataForm.valid?this.data||(this.dataForm.patchValue({regionId:this.regionId,agenciaId:this.agenciaId,nro_solicitud:this.nroSolicitud,respaldo:this.respaldo,caedecId:this.caedecId,subcategoriaId:this.subcategoriaId,inversionElegibleId:this.inversionElegibleId,monto_inv_mn:this.MontoInvBS,monto_inv_me:this.montoInvMe,produccion_energia_anual:this.dataForm.get("con_elec_total")?.value|0,reduccion_emisiones_anual:this.dataForm.get("red_emi_anual")?.value|0,potencia_inst_sis:this.dataForm.get("pot_inst_sis")?.value|0,vida_util:this.dataForm.get("vida_util_c")?.value|0}),this.ecoService.crearEcoeficiencia(this.dataForm.value).subscribe({next:t=>{this.resetdataForm(),this.toastr.success("Ecoeficiencia registrada con exito!"),this.dataOds.ecoId=t,console.log(this.dataOds),this.odsService.crearOds(this.dataOds).subscribe({next:()=>{this.toastr.success("Ods registrados")}})},error:t=>{console.error("Error al actualizar Ecoeficiencia:",t),this.toastr.error("No se pudo registrar Ecoeficiencia. Int\xE9ntelo nuevamente m\xE1s tarde.")}})):this.dataForm.markAllAsTouched()}resetdataForm(){this.dataForm.reset(),this.onClose()}onClose(){this.onCloseModalEbSb.emit(!1),this.dataForm.reset(),this.montoMe=0,this.montoInvMe=0}static \u0275fac=function(n){return new(n||a)(P(le),P(V))};static \u0275cmp=R({type:a,selectors:[["app-eb-sb"]],inputs:{dataOds:"dataOds",montoInvMe:"montoInvMe",regionId:"regionId",agenciaId:"agenciaId",nroSolicitud:"nroSolicitud",caedecId:"caedecId",respaldo:"respaldo",subcategoriaId:"subcategoriaId",inversionElegibleId:"inversionElegibleId",MontoInvBS:"MontoInvBS",data:"data"},outputs:{onCloseModalEbSb:"onCloseModalEbSb"},standalone:!0,features:[G,j],decls:49,vars:33,consts:[[1,"mb-5","text-lg","font-bold","tracking-tight","text-gray-900","dark:text-white"],[1,"w-full",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-4"],[1,"relative","mt-6","flex","items-center"],["type","number","name","pot_nomi_bom","id","pot_nomi_bom","placeholder","pot_nomi_bom","formControlName","pot_nomi_bom","autocomplete","NA","step","0.01",1,"peer","mt-1","w-96","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","pot_nomi_bom",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["class","absolute -right-4 text-red-500",4,"ngIf"],["type","unidades","name","unidades","id","unidades","placeholder","unidades","formControlName","unidades","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["type","con_elec_total","name","con_elec_total","id","con_elec_total","placeholder","con_elec_total","formControlName","con_elec_total","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","con_elec_total",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","pre_equi_ins","name","pre_equi_ins","id","pre_equi_ins","placeholder","pre_equi_ins","formControlName","pre_equi_ins","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","pre_equi_ins",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","hrs_ope_anual","name","hrs_ope_anual","id","hrs_ope_anual","placeholder","hrs_ope_anual","formControlName","hrs_ope_anual","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","hrs_ope_anual",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","vida_util_c","name","vida_util_c","id","vida_util_c","placeholder","vida_util_c","formControlName","vida_util_c","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","vida_util",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","aho_ene_total","name","aho_ene_total","id","aho_ene_total","placeholder","aho_ene_total","formControlName","aho_ene_total","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","aho_ene_total",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","red_emi_anual","name","red_emi_anual","id","red_emi_anual","placeholder","red_emi_anual","formControlName","red_emi_anual","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","red_emi_anual",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],[1,"my-5"],["type","submit",1,"text-white","bg-blue-600","hover:bg-blue-700","font-medium","rounded-lg","w-full","sm:w-auto","px-5","py-2.5","text-center"],["type","button",1,"text-white","ms-2","bg-gray-700","hover:bg-gray-800","font-medium","rounded-lg","w-full","sm:w-auto","px-5","py-2.5","text-center",3,"click"],[1,"absolute","-right-4","text-red-500"]],template:function(n,e){if(n&1&&(i(0,"h5",0),r(1,`Datos para Desarrollo de Proyecto EB-SB
`),o(),i(2,"form",1),b("ngSubmit",function(){return e.onSubmit()}),i(3,"div",2)(4,"div",3),g(5,"input",4),i(6,"label",5),r(7," Potencia N.B.(kW)"),o(),u(8,Yt,2,0,"div",6),o(),i(9,"div",3),g(10,"input",7),i(11,"label",5),r(12," Unidades"),o(),u(13,Zt,2,0,"div",6),o(),i(14,"div",3),g(15,"input",8),i(16,"label",9),r(17," Consumo o Produccion elec. total (MWh/ anual)"),o(),u(18,eo,2,0,"div",6),o(),i(19,"div",3),g(20,"input",10),i(21,"label",11),r(22," Precio equipo+Instal.(USD)"),o(),u(23,to,2,0,"div",6),o(),i(24,"div",3),g(25,"input",12),i(26,"label",13),r(27," Operacion Anual(Hrs)"),o(),u(28,oo,2,0,"div",6),o(),i(29,"div",3),g(30,"input",14),i(31,"label",15),r(32," Vida Util(A\xF1os)"),o(),u(33,io,2,0,"div",6),o(),i(34,"div",3),g(35,"input",16),i(36,"label",17),r(37," Ahorro ener. total(kWh)"),o(),u(38,no,2,0,"div",6),o(),i(39,"div",3),g(40,"input",18),i(41,"label",19),r(42," Reducci\xF3n Emisiones Anuales (tCO2eq/a\xF1o)"),o(),u(43,ao,2,0,"div",6),o()(),i(44,"div",20)(45,"button",21),r(46,"Confirmar"),o(),i(47,"button",22),b("click",function(){return e.onClose()}),r(48,"Cancel"),o()()()),n&2){let d,c,_,p,v,S,I,C,w,M,N,B,x,D,y,F;l(2),s("formGroup",e.dataForm),l(3),s("ngClass",h(17,me,((d=e.dataForm.get("pot_nomi_bom"))==null?null:d.hasError("required"))&&((d=e.dataForm.get("pot_nomi_bom"))==null?null:d.touched))),l(3),s("ngIf",((c=e.dataForm.get("pot_nomi_bom"))==null?null:c.hasError("required"))&&((c=e.dataForm.get("pot_nomi_bom"))==null?null:c.touched)),l(2),s("ngClass",h(19,me,((_=e.dataForm.get("unidades"))==null?null:_.hasError("required"))&&((_=e.dataForm.get("unidades"))==null?null:_.touched))),l(3),s("ngIf",((p=e.dataForm.get("unidades"))==null?null:p.hasError("required"))&&((p=e.dataForm.get("unidades"))==null?null:p.touched)),l(2),s("ngClass",h(21,me,((v=e.dataForm.get("con_elec_total"))==null?null:v.hasError("required"))&&((v=e.dataForm.get("con_elec_total"))==null?null:v.touched))),l(3),s("ngIf",((S=e.dataForm.get("con_elec_total"))==null?null:S.hasError("required"))&&((S=e.dataForm.get("con_elec_total"))==null?null:S.touched)),l(2),s("ngClass",h(23,me,((I=e.dataForm.get("pre_equi_ins"))==null?null:I.hasError("required"))&&((I=e.dataForm.get("pre_equi_ins"))==null?null:I.touched))),l(3),s("ngIf",((C=e.dataForm.get("pre_equi_ins"))==null?null:C.hasError("required"))&&((C=e.dataForm.get("pre_equi_ins"))==null?null:C.touched)),l(2),s("ngClass",h(25,me,((w=e.dataForm.get("hrs_ope_anual"))==null?null:w.hasError("required"))&&((w=e.dataForm.get("hrs_ope_anual"))==null?null:w.touched))),l(3),s("ngIf",((M=e.dataForm.get("hrs_ope_anual"))==null?null:M.hasError("required"))&&((M=e.dataForm.get("hrs_ope_anual"))==null?null:M.touched)),l(2),s("ngClass",h(27,me,((N=e.dataForm.get("vida_util_c"))==null?null:N.hasError("required"))&&((N=e.dataForm.get("vida_util_c"))==null?null:N.touched))),l(3),s("ngIf",((B=e.dataForm.get("vida_util_c"))==null?null:B.hasError("required"))&&((B=e.dataForm.get("vida_util_c"))==null?null:B.touched)),l(2),s("ngClass",h(29,me,((x=e.dataForm.get("aho_ene_total"))==null?null:x.hasError("required"))&&((x=e.dataForm.get("aho_ene_total"))==null?null:x.touched))),l(3),s("ngIf",((D=e.dataForm.get("aho_ene_total"))==null?null:D.hasError("required"))&&((D=e.dataForm.get("aho_ene_total"))==null?null:D.touched)),l(2),s("ngClass",h(31,me,((y=e.dataForm.get("red_emi_anual"))==null?null:y.hasError("required"))&&((y=e.dataForm.get("red_emi_anual"))==null?null:y.touched))),l(3),s("ngIf",((F=e.dataForm.get("red_emi_anual"))==null?null:F.hasError("required"))&&((F=e.dataForm.get("red_emi_anual"))==null?null:F.touched))}},dependencies:[H,te,$,se,ie,z,ne,K,oe,ae,re]})};var q=a=>({"border-red-500":a});function ro(a,t){if(a&1&&(i(0,"option",46),r(1),o()),a&2){let n=t.$implicit;s("value",n.value),l(),T(" ",n.name," ")}}function lo(a,t){a&1&&(i(0,"div",47),r(1," * "),o())}function so(a,t){a&1&&(i(0,"div",47),r(1," * "),o())}function co(a,t){a&1&&(i(0,"div",47),r(1," * "),o())}function mo(a,t){if(a&1&&(i(0,"option",46),r(1),o()),a&2){let n=t.$implicit;s("value",n.value),l(),T(" ",n.name," ")}}function uo(a,t){a&1&&(i(0,"div",47),r(1," * "),o())}function po(a,t){if(a&1&&(i(0,"option",46),r(1),o()),a&2){let n=t.$implicit;s("value",n.value),l(),T(" ",n.name," ")}}function go(a,t){a&1&&(i(0,"div",47),r(1," * "),o())}function _o(a,t){if(a&1&&(i(0,"option",46),r(1),o()),a&2){let n=t.$implicit;s("value",n.value),l(),T(" ",n.name," ")}}function fo(a,t){a&1&&(i(0,"div",47),r(1," * "),o())}function ho(a,t){a&1&&(i(0,"div",47),r(1," * "),o())}function bo(a,t){a&1&&(i(0,"div",47),r(1," * "),o())}function vo(a,t){a&1&&(i(0,"div",47),r(1," * "),o())}function Eo(a,t){a&1&&(i(0,"div",47),r(1," * "),o())}function Co(a,t){a&1&&(i(0,"div",47),r(1," * "),o())}function yo(a,t){a&1&&(i(0,"div",47),r(1," * "),o())}function So(a,t){a&1&&(i(0,"div",47),r(1," * "),o())}function xo(a,t){a&1&&(i(0,"div",47),r(1," * "),o())}function Fo(a,t){a&1&&(i(0,"div",47),r(1," * "),o())}function Io(a,t){a&1&&(i(0,"div",47),r(1," * "),o())}function wo(a,t){a&1&&(i(0,"div",47),r(1," * "),o())}function Mo(a,t){a&1&&(i(0,"div",47),r(1," * "),o())}var $e=class a{constructor(t,n){this.fb=t;this.ecoService=n;this.dataForm=this.fb.group({usuarioId:new m(0),regionId:new m(0),agenciaId:new m(0),nro_solicitud:new m(""),caedecId:new m(0),respaldo:new m(""),subcategoriaId:new m(0),inversionElegibleId:new m(0),monto_inv_mn:new m(0),monto_inv_me:new m(0),produccion_energia_anual:new m(0),reduccion_emisiones_anual:new m(0),potencia_inst_sis:new m(0),vida_util:new m(0),seg_cli:new m("",[f.required]),tipo_ser:new m("",[f.required]),region:new m("",[f.required]),nro_camas:new m(""),factor_ocu:new m(""),nro_col_sol:new m({value:"",disabled:!0},[f.required]),temp_ini_agua:new m({value:"",disabled:!0},[f.required]),temp_fin_agua:new m({value:"",disabled:!0},[f.required]),area_col_sol:new m({value:"",disabled:!0},[f.required]),calor_esp_agua:new m({value:"",disabled:!0},[f.required]),vida_util_c:new m({value:"",disabled:!0},[f.required]),tecnologia:new m("",[f.required]),efi_reg_elec:new m({value:"",disabled:!0},[f.required]),con_ener_anual:new m({value:"",disabled:!0},[f.required]),por_aho_anual:new m({value:"",disabled:!0},[f.required]),aho_ener_anual:new m({value:"",disabled:!0},[f.required]),aho_ener_total:new m({value:"",disabled:!0},[f.required]),red_emi_anual:new m({value:"",disabled:!0},[f.required])})}dataOds=null;montoInvMe;regionId;agenciaId;nroSolicitud;caedecId;respaldo;subcategoriaId;inversionElegibleId;MontoInvBS;onCloseModalEbCa=new W;dataForm;lbService=E(Ce);regInstService=E(Se);pftService=E(ye);regionesInstList=[];segmentoClienteList=[];tipoServicioList=[];tecnologiaList=[];authService=E(Ee);toastr=E(Q);SegCliAuxList=[];lineaBaseAux=[];regionesInst=[];factorOcupacionF10;regionSelecGhi;nroCamaSegF9;data=null;odsService=E(de);ngOnChanges(){this.montoInvMe&&console.log(this.montoInvMe)}onSubmit(){this.dataForm.valid?this.data||(this.dataForm.patchValue({regionId:this.regionId,agenciaId:this.agenciaId,nro_solicitud:this.nroSolicitud,respaldo:this.respaldo,caedecId:this.caedecId,subcategoriaId:this.subcategoriaId,inversionElegibleId:this.inversionElegibleId,monto_inv_mn:this.MontoInvBS,monto_inv_me:this.montoInvMe,produccion_energia_anual:this.dataForm.get("aho_ener_anual")?.value|0,reduccion_emisiones_anual:this.dataForm.get("red_emi_anual")?.value|0,potencia_inst_sis:this.dataForm.get("pot_inst_sis")?.value|0,vida_util:this.dataForm.get("vida_util_c")?.value|0}),console.log(this.dataForm.value),this.ecoService.crearEcoeficiencia(this.dataForm.value).subscribe({next:t=>{this.resetdataForm(),this.toastr.success("Ecoeficiencia registrada con exito!"),this.dataOds.ecoId=t,console.log(this.dataOds),this.odsService.crearOds(this.dataOds).subscribe({next:()=>{this.toastr.success("Ods registrados")}})},error:t=>{this.toastr.error("No se pudo registrar Ecoeficiencia. Int\xE9ntelo nuevamente m\xE1s tarde.")}})):this.dataForm.markAllAsTouched()}ngOnInit(){this.authService.userId$.subscribe(t=>{this.dataForm.patchValue({usuarioId:parseInt(t[0])})}),this.Regiones(),this.SegmentoCliente(),this.TipoServicio(),this.tecnologia(),this.lbService.getLineaBase().subscribe({next:t=>{this.lineaBaseAux=t;let n=this.lineaBaseAux.filter(_=>_.proyecto.trim()==="EBCA_LBG_CS_CEA"),e=n.length>0?n[0].medida:0;this.dataForm.get("calor_esp_agua")?.setValue(e,{emitEvent:!1});let d=this.lineaBaseAux.filter(_=>_.proyecto.trim()==="EBCA_LBG_CS_VU"),c=d.length>0?d[0].medida:0;this.dataForm.get("vida_util_c")?.setValue(c,{emitEvent:!1})},error:t=>{this.toastr.warning("Error al cargar Linea Base",t)}}),this.pftService.getPrecioFactorTasa().subscribe({next:t=>{this.SegCliAuxList=t;let n=this.SegCliAuxList.filter(v=>v.tipo.trim()==="EBCA_CAC_TFA"),e=n.length>0?n[0].valor:0;console.log(e),this.dataForm.get("temp_fin_agua")?.setValue(e,{emitEvent:!1});let d=this.SegCliAuxList.filter(v=>v.tipo.trim()==="EBCA_CAC_TIA"),c=d.length>0?d[0].valor:0;console.log(c),this.dataForm.get("temp_ini_agua")?.setValue(c,{emitEvent:!1});let _=this.SegCliAuxList.filter(v=>v.tipo.trim()==="EBCA_ACSDR_CAC"),p=_.length>0?_[0].valor:0;console.log(p),this.dataForm.get("area_col_sol")?.setValue(p,{emitEvent:!1})},error:t=>{this.toastr.warning("Error al cargar EBCA_NCPS(Precios factot Tasa):",t)}})}tecnologia(){this.pftService.getPrecioFactorTasa().subscribe({next:t=>{this.tecnologiaList=t.filter(n=>n.tipo==="EBCA_TLB_EC").map(n=>({value:n.id,name:n.descripcion,unidad:n.unidad,valor:n.valor}))},error:t=>{this.toastr.warning("Error al cargartecnologia):",t)}})}TipoServicio(){this.pftService.getPrecioFactorTasa().subscribe({next:t=>{this.tipoServicioList=t.filter(n=>n.tipo==="EBCA_FOTU").map(n=>({value:n.id,name:n.descripcion,unidad:n.unidad,valor:n.valor}))},error:t=>{this.toastr.warning("Error al cargar EBCA_FOTU(Precios factot Tasa):",t)}})}SegmentoCliente(){this.pftService.getPrecioFactorTasa().subscribe({next:t=>{this.segmentoClienteList=t.filter(n=>n.tipo==="EBCA_NCPS").map(n=>({value:n.id,name:n.descripcion,unidad:n.unidad,valor:n.valor}))},error:t=>{this.toastr.warning("Error al cargar EBCA_NCPS(Precios factot Tasa):",t)}})}Regiones(){this.regInstService.getRegionesInstalacion().subscribe({next:t=>{this.regionesInst=t,this.regionesInstList=t.map(n=>({value:n.id,name:n.region,ghi:n.ghi}))},error:t=>{this.toastr.warning("Error al cargar Regiones Instalacion:",t)}})}onRegionChange(t){let e=+t.target.value;console.log(e),console.log(this.regionesInst);let d=this.regionesInst.filter(c=>c.id===e);this.regionSelecGhi=d.length>0?d[0].ghi:0}onTipoServicioChange(t){let e=+t.target.value,d=this.dataForm.get("factor_ocu")?.value;if(d)this.factorOcupacionF10=d;else{let c=this.SegCliAuxList.filter(_=>_.id===e);this.factorOcupacionF10=c.length>0?c[0].valor:0}this.NroColectoresSolares()}onSegCliChange(t){let e=+t.target.value,d=this.dataForm.get("nro_camas")?.value;if(d)this.nroCamaSegF9=d;else{let c=this.SegCliAuxList.filter(_=>_.id===e);this.nroCamaSegF9=c.length>0?c[0].valor:0}this.NroColectoresSolares()}selectedValor=0;onTecnologiaChange(t){let e=+t.target.value,d=this.SegCliAuxList.filter(_=>_.id===e),c=d.length>0?d[0].valor:0;this.dataForm.get("efi_reg_elec")?.setValue(c,{emitEvent:!1})}NroColectoresSolares(){console.log(this.SegCliAuxList),console.log("Fcator Ocupacion F10",this.factorOcupacionF10),console.log("Nro Camas por seg.. F9",this.nroCamaSegF9);let t=this.SegCliAuxList.filter(c=>c.tipo==="EBCA_CACPLD"),n=t.length>0?t[0].valor:0,e=this.SegCliAuxList.filter(c=>c.tipo==="EBCA_ECS"),d=e.length>0?e[0].valor:0;this.lbService.getLineaBase().subscribe({next:c=>{let _=c.filter(B=>B.proyecto.trim()==="EBCA_LBG_CS_CEA"),p=_.length>0?_[0].medida:0,v=this.dataForm.get("temp_fin_agua")?.value-this.dataForm.get("temp_ini_agua")?.value,S=this.dataForm.get("efi_reg_elec")?.value;this.dataForm.get("con_ener_anual")?.setValue((n*(p/3.6/1e3)*v*365*this.nroCamaSegF9*this.factorOcupacionF10/S).toFixed(0),{emitEvent:!1});let I=this.dataForm.get("area_col_sol")?.value;this.dataForm.get("nro_col_sol")?.setValue(Math.ceil(n*(p/3.6/1e3)*v*365*this.nroCamaSegF9*this.factorOcupacionF10/S/(this.regionSelecGhi*(d/100))/I),{emitEvent:!1});let C=n*(p/3.6/1e3)*v*365*this.nroCamaSegF9*this.factorOcupacionF10/S-n*(p/3.6/1e3)*v*365*this.nroCamaSegF9*(this.factorOcupacionF10/100)*.2;this.dataForm.get("aho_ener_anual")?.setValue(C.toFixed(0),{emitEvent:!1}),this.dataForm.get("por_aho_anual")?.setValue((C/(n*(p/3.6/1e3)*v*365*this.nroCamaSegF9*this.factorOcupacionF10/S)*100).toFixed(0),{emitEvent:!1});let w=this.dataForm.get("vida_util_c")?.value;this.dataForm.get("aho_ener_total")?.setValue((C*w).toFixed(0),{emitEvent:!1});let M=this.dataForm.get("tecnologia")?.value;console.log(M);let N=this.tecnologiaList.find(B=>B.value===+M);if(N)switch(this.selectedValor=N.valor,N?.name){case"Regaderas el\xE9ctricas":this.dataForm.get("red_emi_anual")?.setValue((C*.604).toFixed(0),{emitEvent:!1});break;case"Calef\xF3n a GLP":this.dataForm.get("red_emi_anual")?.setValue((C*.227).toFixed(0),{emitEvent:!1});break;case"Calef\xF3n a Di\xE9sel":this.dataForm.get("red_emi_anual")?.setValue((C*(.604/10.03)).toFixed(0),{emitEvent:!1});break;case"Calef\xF3n a Gas natural":this.dataForm.get("red_emi_anual")?.setValue((C*.202).toFixed(0),{emitEvent:!1});break}else this.selectedValor=0},error:c=>{this.toastr.warning("Error al cargar datos de linea base:",c)}})}resetdataForm(){this.dataForm.reset(),this.onClose()}onClose(){this.onCloseModalEbCa.emit(!1)}static \u0275fac=function(n){return new(n||a)(P(le),P(V))};static \u0275cmp=R({type:a,selectors:[["app-eb-ca"]],inputs:{dataOds:"dataOds",montoInvMe:"montoInvMe",regionId:"regionId",agenciaId:"agenciaId",nroSolicitud:"nroSolicitud",caedecId:"caedecId",respaldo:"respaldo",subcategoriaId:"subcategoriaId",inversionElegibleId:"inversionElegibleId",MontoInvBS:"MontoInvBS",data:"data"},outputs:{onCloseModalEbCa:"onCloseModalEbCa"},standalone:!0,features:[G,j],decls:111,vars:77,consts:[[1,"mb-5","text-lg","font-bold","tracking-tight","text-gray-900","dark:text-white"],[1,"w-full",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mb-4"],[1,"relative","mt-1","flex","items-center"],["id","tecnologia","formControlName","tecnologia","autocomplete","NA",1,"peer","mt-1","w-96","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"change","ngClass"],["value","","selected",""],[3,"value",4,"ngFor","ngForOf"],["for","tecnologia",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["class","absolute -right-4 text-red-500",4,"ngIf"],["type","number","name","nro_camas","id","nro_camas","placeholder","nro_camas","formControlName","nro_camas","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","nro_camas",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","number","name","factor_ocu","id","factor_ocu","placeholder","factor_ocu","formControlName","factor_ocu","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","factor_ocu",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["id","region","formControlName","region","autocomplete","NA",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"change","ngClass"],["for","region",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["id","tipo_ser","formControlName","tipo_ser","autocomplete","NA",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"change","ngClass"],["for","tipo_ser",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["id","seg_cli","formControlName","seg_cli","autocomplete","NA",1,"peer","mt-1","w-96","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"change","ngClass"],["for","seg_cli",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","number","name","nro_col_sol","id","factor_ocu","placeholder","factor_ocu","formControlName","nro_col_sol","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","nro_col_sol",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","number","name","temp_ini_agua","id","temp_ini_agua","placeholder","temp_ini_agua","formControlName","temp_ini_agua","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","temp_ini_agua",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","number","name","temp_fin_agua","id","temp_fin_agua","placeholder","temp_fin_agua","formControlName","temp_fin_agua","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","temp_fin_agua",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","number","name","area_col_sol","id","area_col_sol","placeholder","area_col_sol","formControlName","area_col_sol","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","area_col_sol",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","number","name","calor_esp_agua","id","calor_esp_agua","placeholder","calor_esp_agua","formControlName","calor_esp_agua","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","calor_esp_agua",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","number","name","vida_util_c","id","vida_util_c","placeholder","vida_util_c","formControlName","vida_util_c","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","vida_util_c",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","number","name","efi_reg_elec","id","efi_reg_elec","placeholder","efi_reg_elec","formControlName","efi_reg_elec","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","efi_reg_elec",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","number","name","con_ener_anual","id","con_ener_anual","placeholder","con_ener_anual","formControlName","con_ener_anual","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","con_ener_anual",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","number","name","por_aho_anual","id","por_aho_anual","placeholder","por_aho_anual","formControlName","por_aho_anual","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","por_aho_anual",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","number","name","aho_ener_anual","id","aho_ener_anual","placeholder","aho_ener_anual","formControlName","aho_ener_anual","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","aho_ener_anual",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","number","name","","id","aho_ener_total","placeholder","aho_ener_total","formControlName","aho_ener_total","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","aho_ener_total",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","number","name","","id","red_emi_anual","placeholder","red_emi_anual","formControlName","red_emi_anual","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","red_emi_anual",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],[1,"my-5"],["type","submit",1,"text-white","bg-blue-600","hover:bg-blue-700","font-medium","rounded-lg","w-full","sm:w-auto","px-5","py-2.5","text-center"],["type","button",1,"text-white","ms-2","bg-gray-700","hover:bg-gray-800","font-medium","rounded-lg","w-full","sm:w-auto","px-5","py-2.5","text-center",3,"click"],[3,"value"],[1,"absolute","-right-4","text-red-500"]],template:function(n,e){if(n&1&&(i(0,"h5",0),r(1,"Ingresar datos para Desarrollo de Proyecto EB-CA"),o(),i(2,"form",1),b("ngSubmit",function(){return e.onSubmit()}),i(3,"div",2)(4,"div",3)(5,"select",4),b("change",function(c){return e.onTecnologiaChange(c)}),i(6,"option",5),r(7,"Seleccione tecnologia"),o(),u(8,ro,2,2,"option",6),o(),i(9,"label",7),r(10," Tecnologia "),o(),u(11,lo,2,0,"div",8),o(),i(12,"div",3),g(13,"input",9),i(14,"label",10),r(15," Nro camas[Uni](opcional)"),o(),u(16,so,2,0,"div",8),o(),i(17,"div",3),g(18,"input",11),i(19,"label",12),r(20," Factor ocupacion[%](opcional)"),o(),u(21,co,2,0,"div",8),o(),i(22,"div",3)(23,"select",13),b("change",function(c){return e.onRegionChange(c)}),i(24,"option",5),r(25,"Seleccione una region"),o(),u(26,mo,2,2,"option",6),o(),i(27,"label",14),r(28," Region de Instalaci\xF3n "),o(),u(29,uo,2,0,"div",8),o(),i(30,"div",3)(31,"select",15),b("change",function(c){return e.onTipoServicioChange(c)}),i(32,"option",5),r(33,"Seleccione servicio"),o(),u(34,po,2,2,"option",6),o(),i(35,"label",16),r(36," Tipo servicio "),o(),u(37,go,2,0,"div",8),o(),i(38,"div",3)(39,"select",17),b("change",function(c){return e.onSegCliChange(c)}),i(40,"option",5),r(41,"Seleccione segmento"),o(),u(42,_o,2,2,"option",6),o(),i(43,"label",18),r(44," Segmento cliente "),o(),u(45,fo,2,0,"div",8),o(),i(46,"div",3),g(47,"input",19),i(48,"label",20),r(49," N\xB0 Colectores Solares [Unidades]"),o(),u(50,ho,2,0,"div",8),o(),i(51,"div",3),g(52,"input",21),i(53,"label",22),r(54," Temperatura inicial Agua [\xB0C]"),o(),u(55,bo,2,0,"div",8),o(),i(56,"div",3),g(57,"input",23),i(58,"label",24),r(59," Temperatura final Agua [\xB0C]"),o(),u(60,vo,2,0,"div",8),o(),i(61,"div",3),g(62,"input",25),i(63,"label",26),r(64," Area Colector Solar [m2]"),o(),u(65,Eo,2,0,"div",8),o(),i(66,"div",3),g(67,"input",27),i(68,"label",28),r(69," Calor Especifico del Agua [\xB0C]"),o(),u(70,Co,2,0,"div",8),o(),i(71,"div",3),g(72,"input",29),i(73,"label",30),r(74," Vida Util [a\xF1os]"),o(),u(75,yo,2,0,"div",8),o(),i(76,"div",3),g(77,"input",31),i(78,"label",32),r(79," Eficiencia Regaderas Electricas[%]"),o(),u(80,So,2,0,"div",8),o(),i(81,"div",3),g(82,"input",33),i(83,"label",34),r(84," Consumo Energeticvo Anual [kWh/a\xF1o]"),o(),u(85,xo,2,0,"div",8),o(),i(86,"div",3),g(87,"input",35),i(88,"label",36),r(89," Porcentaje Ahorro Anual [%]"),o(),u(90,Fo,2,0,"div",8),o(),i(91,"div",3),g(92,"input",37),i(93,"label",38),r(94," Ahorro enregia anual [kWh/a\xF1o]"),o(),u(95,Io,2,0,"div",8),o(),i(96,"div",3),g(97,"input",39),i(98,"label",40),r(99," Ahorro enregia total [kWh]"),o(),u(100,wo,2,0,"div",8),o(),i(101,"div",3),g(102,"input",41),i(103,"label",42),r(104," Reducci\xF3n de emisiones anuales [kWh]"),o(),u(105,Mo,2,0,"div",8),o()(),i(106,"div",43)(107,"button",44),r(108,"Confirmar"),o(),i(109,"button",45),b("click",function(){return e.onClose()}),r(110,"Cancel"),o()()()),n&2){let d,c,_,p,v,S,I,C,w,M,N,B,x,D,y,F,O,A,k,L,pe,ge,_e,Ie,we,Me,De,Te,Ne,Be,Oe,qe,Ae,ke,Ve,Le;l(2),s("formGroup",e.dataForm),l(3),s("ngClass",h(41,q,((d=e.dataForm.get("tecnologia"))==null?null:d.hasError("required"))&&((d=e.dataForm.get("tecnologia"))==null?null:d.touched))),l(3),s("ngForOf",e.tecnologiaList),l(3),s("ngIf",((c=e.dataForm.get("tecnologia"))==null?null:c.hasError("required"))&&((c=e.dataForm.get("tecnologia"))==null?null:c.touched)),l(2),s("ngClass",h(43,q,((_=e.dataForm.get("nro_camas"))==null?null:_.hasError("required"))&&((_=e.dataForm.get("nro_camas"))==null?null:_.touched))),l(3),s("ngIf",((p=e.dataForm.get("nro_camas"))==null?null:p.hasError("required"))&&((p=e.dataForm.get("nro_camas"))==null?null:p.touched)),l(2),s("ngClass",h(45,q,((v=e.dataForm.get("factor_ocu"))==null?null:v.hasError("required"))&&((v=e.dataForm.get("factor_ocu"))==null?null:v.touched))),l(3),s("ngIf",((S=e.dataForm.get("factor_ocu"))==null?null:S.hasError("required"))&&((S=e.dataForm.get("factor_ocu"))==null?null:S.touched)),l(2),s("ngClass",h(47,q,((I=e.dataForm.get("region"))==null?null:I.hasError("required"))&&((I=e.dataForm.get("region"))==null?null:I.touched))),l(3),s("ngForOf",e.regionesInstList),l(3),s("ngIf",((C=e.dataForm.get("region"))==null?null:C.hasError("required"))&&((C=e.dataForm.get("region"))==null?null:C.touched)),l(2),s("ngClass",h(49,q,((w=e.dataForm.get("tipo_ser"))==null?null:w.hasError("required"))&&((w=e.dataForm.get("tipo_ser"))==null?null:w.touched))),l(3),s("ngForOf",e.tipoServicioList),l(3),s("ngIf",((M=e.dataForm.get("tipo_ser"))==null?null:M.hasError("required"))&&((M=e.dataForm.get("tipo_ser"))==null?null:M.touched)),l(2),s("ngClass",h(51,q,((N=e.dataForm.get("seg_cli"))==null?null:N.hasError("required"))&&((N=e.dataForm.get("seg_cli"))==null?null:N.touched))),l(3),s("ngForOf",e.segmentoClienteList),l(3),s("ngIf",((B=e.dataForm.get("seg_cli"))==null?null:B.hasError("required"))&&((B=e.dataForm.get("seg_cli"))==null?null:B.touched)),l(2),s("ngClass",h(53,q,((x=e.dataForm.get("nro_col_sol"))==null?null:x.hasError("required"))&&((x=e.dataForm.get("nro_col_sol"))==null?null:x.touched))),l(3),s("ngIf",((D=e.dataForm.get("nro_col_sol"))==null?null:D.hasError("required"))&&((D=e.dataForm.get("nro_col_sol"))==null?null:D.touched)),l(2),s("ngClass",h(55,q,((y=e.dataForm.get("temp_ini_agua"))==null?null:y.hasError("required"))&&((y=e.dataForm.get("temp_ini_agua"))==null?null:y.touched))),l(3),s("ngIf",((F=e.dataForm.get("temp_ini_agua"))==null?null:F.hasError("required"))&&((F=e.dataForm.get("temp_ini_agua"))==null?null:F.touched)),l(2),s("ngClass",h(57,q,((O=e.dataForm.get("temp_fin_agua"))==null?null:O.hasError("required"))&&((O=e.dataForm.get("temp_fin_agua"))==null?null:O.touched))),l(3),s("ngIf",((A=e.dataForm.get("temp_fin_agua"))==null?null:A.hasError("required"))&&((A=e.dataForm.get("temp_fin_agua"))==null?null:A.touched)),l(2),s("ngClass",h(59,q,((k=e.dataForm.get("area_col_sol"))==null?null:k.hasError("required"))&&((k=e.dataForm.get("area_col_sol"))==null?null:k.touched))),l(3),s("ngIf",((L=e.dataForm.get("area_col_sol"))==null?null:L.hasError("required"))&&((L=e.dataForm.get("area_col_sol"))==null?null:L.touched)),l(2),s("ngClass",h(61,q,((pe=e.dataForm.get("calor_esp_agua"))==null?null:pe.hasError("required"))&&((pe=e.dataForm.get("calor_esp_agua"))==null?null:pe.touched))),l(3),s("ngIf",((ge=e.dataForm.get("calor_esp_agua"))==null?null:ge.hasError("required"))&&((ge=e.dataForm.get("calor_esp_agua"))==null?null:ge.touched)),l(2),s("ngClass",h(63,q,((_e=e.dataForm.get("vida_util_c"))==null?null:_e.hasError("required"))&&((_e=e.dataForm.get("vida_util_c"))==null?null:_e.touched))),l(3),s("ngIf",((Ie=e.dataForm.get("vida_util_c"))==null?null:Ie.hasError("required"))&&((Ie=e.dataForm.get("vida_util_c"))==null?null:Ie.touched)),l(2),s("ngClass",h(65,q,((we=e.dataForm.get("efi_reg_elec"))==null?null:we.hasError("required"))&&((we=e.dataForm.get("efi_reg_elec"))==null?null:we.touched))),l(3),s("ngIf",((Me=e.dataForm.get("efi_reg_elec"))==null?null:Me.hasError("required"))&&((Me=e.dataForm.get("efi_reg_elec"))==null?null:Me.touched)),l(2),s("ngClass",h(67,q,((De=e.dataForm.get("con_ener_anual"))==null?null:De.hasError("required"))&&((De=e.dataForm.get("con_ener_anual"))==null?null:De.touched))),l(3),s("ngIf",((Te=e.dataForm.get("con_ener_anual"))==null?null:Te.hasError("required"))&&((Te=e.dataForm.get("con_ener_anual"))==null?null:Te.touched)),l(2),s("ngClass",h(69,q,((Ne=e.dataForm.get("por_aho_anual"))==null?null:Ne.hasError("required"))&&((Ne=e.dataForm.get("por_aho_anual"))==null?null:Ne.touched))),l(3),s("ngIf",((Be=e.dataForm.get("por_aho_anual"))==null?null:Be.hasError("required"))&&((Be=e.dataForm.get("por_aho_anual"))==null?null:Be.touched)),l(2),s("ngClass",h(71,q,((Oe=e.dataForm.get("aho_ener_anual"))==null?null:Oe.hasError("required"))&&((Oe=e.dataForm.get("aho_ener_anual"))==null?null:Oe.touched))),l(3),s("ngIf",((qe=e.dataForm.get("aho_ener_anual"))==null?null:qe.hasError("required"))&&((qe=e.dataForm.get("aho_ener_anual"))==null?null:qe.touched)),l(2),s("ngClass",h(73,q,((Ae=e.dataForm.get("aho_ener_total"))==null?null:Ae.hasError("required"))&&((Ae=e.dataForm.get("aho_ener_total"))==null?null:Ae.touched))),l(3),s("ngIf",((ke=e.dataForm.get("aho_ener_total"))==null?null:ke.hasError("required"))&&((ke=e.dataForm.get("aho_ener_total"))==null?null:ke.touched)),l(2),s("ngClass",h(75,q,((Ve=e.dataForm.get("red_emi_anual"))==null?null:Ve.hasError("required"))&&((Ve=e.dataForm.get("red_emi_anual"))==null?null:Ve.touched))),l(3),s("ngIf",((Le=e.dataForm.get("red_emi_anual"))==null?null:Le.hasError("required"))&&((Le=e.dataForm.get("red_emi_anual"))==null?null:Le.touched))}},dependencies:[H,te,fe,$,se,ie,be,ve,z,ne,he,K,oe,ae,re]})};var X=a=>({"border-red-500":a});function Do(a,t){if(a&1&&(i(0,"option",72),r(1),o()),a&2){let n=t.$implicit;s("value",n.value),l(),T(" ",n.name," ")}}function To(a,t){a&1&&(i(0,"div",73),r(1," * "),o())}function No(a,t){if(a&1&&(i(0,"option",72),r(1),o()),a&2){let n=t.$implicit;s("value",n.value),l(),T(" ",n.name," ")}}function Bo(a,t){a&1&&(i(0,"div",73),r(1," * "),o())}function Oo(a,t){a&1&&(i(0,"div",73),r(1," * "),o())}function qo(a,t){a&1&&(i(0,"div",73),r(1," * "),o())}function Ao(a,t){if(a&1){let n=ue();i(0,"li",76),b("click",function(){let d=J(n).$implicit,c=U(2);return Y(c.selectItem(d))}),r(1),o()}if(a&2){let n=t.$implicit;l(),T(" ",n.nombre," ")}}function ko(a,t){if(a&1){let n=ue();i(0,"ul",74),b("mousedown",function(){J(n);let d=U();return Y(d.dropdownClicked=!0)}),u(1,Ao,2,1,"li",75),o()}if(a&2){let n=U();l(),s("ngForOf",n.filteredItems)}}function Vo(a,t){if(a&1&&(i(0,"option",72),r(1),o()),a&2){let n=t.$implicit;s("value",n.value),l(),T(" ",n.name," ")}}function Lo(a,t){a&1&&(i(0,"div",73),r(1," * "),o())}function Po(a,t){a&1&&(i(0,"div",73),r(1," * "),o())}function Ro(a,t){a&1&&(i(0,"div",73),r(1," * "),o())}function Uo(a,t){a&1&&(i(0,"div",73),r(1," * "),o())}function jo(a,t){if(a&1&&(i(0,"option",72),r(1),o()),a&2){let n=t.$implicit;s("value",n.value),l(),T(" ",n.name," ")}}function Ho(a,t){a&1&&(i(0,"div",73),r(1," * "),o())}function Go(a,t){if(a&1&&(i(0,"option",72),r(1),o()),a&2){let n=t.$implicit;s("value",n.value),l(),T(" ",n.name," ")}}function Wo(a,t){a&1&&(i(0,"div",73),r(1," * "),o())}function $o(a,t){if(a&1&&(i(0,"div",77),g(1,"img",78),i(2,"div",79)(3,"p",80)(4,"span",81),r(5,"Categor\xEDa:"),o(),r(6),o(),i(7,"p",82)(8,"span",81),r(9,"Tipo de Energ\xEDa:"),o(),r(10),o(),i(11,"p",82)(12,"span",81),r(13,"L\xEDnea Base:"),o(),r(14),o(),i(15,"p",83)(16,"span",81),r(17,"Criterio de Elegibilidad:"),o(),r(18),o()()()),a&2){let n=U();l(),s("src","data:image/jpeg;base64,"+n.selectedImage,ot),l(5),T(" ",n.selectedCategory," "),l(4),T(" ",n.selectedIndicadorEfiEner," "),l(4),T(" ",n.selectedLineaBase," "),l(4),T(" ",n.selectedCriterioElegible," ")}}var ze=class a{constructor(t,n,e){this.fb=t;this.ecoeficienciaService=n;this.toastr=e;this.dataForm=this.fb.group({regionId:new m("",[f.required]),agencia:new m("",[f.required]),nro_solicitud:new m("",[f.required]),nivel_medida:new m("",[f.required]),caedecId:new m(""),respaldo:new m("",[f.required]),monto_inv_mn:new m("",[f.required,f.pattern(/^\d+(\.\d{1,2})?$/)]),tipo_cambio:new m(6.96,[f.required,f.pattern(/^\d+(\.\d{1,2})?$/)]),subcategoria:new m("",[f.required]),monto_inv_me:new m({value:"",disabled:!0},[f.required]),tipo_tecnologia:new m("",[f.required]),fin_pobreza:new m(!1),hambre_cero:new m(!1),salud_bienestar:new m(!1),educacion_calidad:new m(!1),igualdad_genero:new m(!1),agua_limp_sanea:new m(!1),enr_ase_nocon:new m(!1),trab_dec_creeco:new m(!1),ind_ino_inf:new m(!1),reduc_desig:new m(!1),ciu_com_sos:new m(!1),prod_con_res:new m(!1),acc_por_cli:new m(!1),vida_sub:new m(!1),vida_eco_terr:new m(!1),paz_jus_instsol:new m(!1),ali_lograr_obj:new m(!1)})}data=null;onCloseModal=new W;caeService=E(bt);subService=E(qt);invEleService=E(At);regService=E(kt);ageService=E(Vt);searchTermControl=new m("");items=[];subcategoriaList=[];regionList=[];agenciaList=[];inversionElegibleList=[];isModalEbFvOpen=!1;isModalEbSbOpen=!1;isModalEbCaOpen=!1;dataForm;ods;regionId;agenciaId;nroSolicitud;caedecId;respaldo;subcategoriaId;inversionElegibleId;MontoInvUSD;MontoInvBS;respaldoList=[{value:"",name:"Seleccione una regi\xF3n"},{value:"Ficha t\xE9cnica",name:"Ficha t\xE9cnica"},{value:"Cotizaci\xF3n/Proforma",name:"Cotizaci\xF3n/Proforma"},{value:"Factura",name:"Factura"},{value:"Estudio de Factibilidad",name:"Estudio de Factibilidad"}];ngOnChanges(){this.data&&this.dataForm.patchValue({regionId:this.data.regionId,nivel_medida:this.data.nivel_medida,respaldo:this.data.respaldo,monto_inv_mn:this.data.monto_inv_mn,monto_inv_me:this.data.monto_inv_me})}ngOnInit(){this.getCaedecs(),this.getSubcategorias(),this.getRegiones(),this.dataForm.get("monto_inv_mn")?.valueChanges.subscribe(()=>this.calculateMontoInvMe()),this.dataForm.get("tipo_cambio")?.valueChanges.subscribe(()=>this.calculateMontoInvMe()),this.searchTermControl.valueChanges.subscribe(()=>{this.showDropdown=!0})}getCaedecs(){this.caeService.getCaedecs().subscribe({next:t=>{this.items=t.map(n=>({nombre:`(${n.actividad}) ${n.nombre}`,actividad:n.actividad,id:n.id}))},error:()=>{this.toastr.error("Error al cargar los datos")}})}getSubcategorias(){this.subService.getSubcategoria().subscribe({next:t=>{console.log(t),this.subcategoriaList=t.map(n=>({value:n.id,name:n.medida_estandar}))},error:()=>{this.toastr.error("Error al cargar las subcategor\xEDas")}})}getRegiones(){this.regService.getRegion().subscribe({next:t=>{console.log(t),this.regionList=t.map(n=>({value:n.id,name:n.nombre}))},error:()=>{this.toastr.error("Error al cargar las subcategor\xEDas")}})}showDropdown=!1;dropdownClicked=!1;get filteredItems(){let t=this.searchTermControl.value?.toLowerCase()??"";return t?this.items.filter(n=>n.nombre.toLowerCase().includes(t)):[]}onSubmit(){if(this.ods=this.dataForm.value,this.dataForm.valid){if(this.regionId=parseInt(this.dataForm.get("regionId")?.value),this.agenciaId=parseInt(this.dataForm.get("agencia")?.value),this.nroSolicitud=this.dataForm.get("nro_solicitud")?.value,this.respaldo=this.dataForm.get("respaldo")?.value,this.subcategoriaId=parseInt(this.dataForm.get("subcategoria")?.value),this.inversionElegibleId=parseInt(this.dataForm.get("tipo_tecnologia")?.value),this.MontoInvBS=parseFloat(this.dataForm.get("monto_inv_mn")?.value),this.MontoInvUSD=parseFloat(this.dataForm.get("monto_inv_me")?.value),!["fin_pobreza","hambre_cero","salud_bienestar","educacion_calidad","igualdad_genero","agua_limp_sanea","enr_ase_nocon","trab_dec_creeco","ind_ino_inf","reduc_desig","ciu_com_sos","prod_con_res","acc_por_cli","vida_sub","vida_eco_terr","paz_jus_instsol","ali_lograr_obj"].some(e=>this.dataForm.get(e)?.value)){this.toastr.error("Debes seleccionar al menos un ODS.");return}switch(this.selectedCriterioElegible){case"Paneles solares On grid u Off Grid":this.openModalEB_FV();break;case"Sistemas de bombeo el\xE9ctrico solar":this.openModalEB_SB();break;case"Calef\xF3n o terma solar":this.openModalEB_CA();break}}else this.dataForm.markAllAsTouched()}onClose(){this.onCloseModal.emit(!1),this.dataForm.reset({regionId:"",agencia:"",respaldo:"",subcategoria:"",tipo_tecnologia:""}),this.dataForm.get("tipo_cambio")?.setValue(6.96),this.selectedImage="",this.selectedCategory="",this.selectedIndicadorEfiEner="",this.selectedLineaBase="",this.selectedCriterioElegible="",this.MontoInvUSD=0}selectItem(t){this.searchTermControl.setValue(t.nombre),this.dataForm.get("nivel_medida")?.setValue(t.nombre),this.caedecId=t.id,this.showDropdown=!1}onDocumentClick(t){(!t.target||!t.target.closest(".relative"))&&(this.showDropdown=!1)}hideDropdown(){setTimeout(()=>{this.dropdownClicked||(this.showDropdown=!1)},100)}calculateMontoInvMe(){let t=this.dataForm.get("monto_inv_mn")?.value,n=this.dataForm.get("tipo_cambio")?.value;if(t&&n){let e=(t/n).toFixed(2);this.dataForm.get("monto_inv_me")?.setValue(e,{emitEvent:!1})}}onRegionChange(t){let e=+t.target.value;e?this.getAgenciasRegion(e):this.agenciaList=[]}onSubcategoriaChange(t){let e=+t.target.value;e?(this.dataForm.get("tipo_tecnologia")?.setValue(""),this.getInvElegibleParaSubcategoria(e)):(this.inversionElegibleList=[],this.dataForm.get("tipo_tecnologia")?.setValue(""))}getAgenciasRegion(t){this.ageService.getAgencia(t).subscribe({next:n=>{this.agenciaList=n.map(e=>({value:e.id,name:e.nombre}))},error:()=>{this.toastr.error("Error al cargar las agencias")}})}getInvElegibleParaSubcategoria(t){this.invEleService.getInversionElegible(t).subscribe({next:n=>{this.inversionElegibleList=n.map(e=>({value:e.id,name:e.nombre,image:e.contenidoB64,categoria:e.categoria,indicador_efi_ener:e.indicador_efi_ener,linea_base:e.linea_base,criterio_elegible:e.criterio_elegible}))},error:n=>{console.error("Error al cargar archivos:",n)}})}selectedImage="";selectedCategory="";selectedIndicadorEfiEner="";selectedLineaBase="";selectedCriterioElegible="";onTipoTecnologiaChange(t){let e=t.target.value,d=this.inversionElegibleList.find(c=>c.value===+e);d?(this.selectedImage=d.image,this.selectedCategory=d.categoria,this.selectedIndicadorEfiEner=d.indicador_efi_ener,this.selectedLineaBase=d.linea_base,this.selectedCriterioElegible=d.criterio_elegible):(this.selectedImage="",this.selectedCategory="",this.selectedIndicadorEfiEner="",this.selectedLineaBase="",this.selectedCriterioElegible="")}openModalEB_FV(){this.isModalEbFvOpen=!0}closeModalEB_FV(){this.isModalEbFvOpen=!1,this.onClose()}openModalEB_SB(){this.isModalEbSbOpen=!0;let t=parseFloat(this.dataForm.get("monto_inv_me")?.value);this.MontoInvUSD=t}closeModalEB_SB(){this.isModalEbSbOpen=!1,this.onClose()}openModalEB_CA(){this.isModalEbCaOpen=!0}closeModalEB_CA(){this.isModalEbCaOpen=!1,this.onClose()}static \u0275fac=function(n){return new(n||a)(P(le),P(V),P(Q))};static \u0275cmp=R({type:a,selectors:[["app-inicio-datos-create"]],hostBindings:function(n,e){n&1&&b("click",function(c){return e.onDocumentClick(c)},!1,it)},inputs:{data:"data"},outputs:{onCloseModal:"onCloseModal"},standalone:!0,features:[G,j],decls:139,vars:82,consts:[[1,"mb-5","text-lg","font-bold","tracking-tight","text-gray-900","dark:text-white"],[1,"w-full",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-4"],[1,"relative","mt-1","flex","items-center"],["id","regionId","formControlName","regionId","autocomplete","NA",1,"peer","mt-1","w-96","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"change","ngClass"],["value","","selected",""],[3,"value",4,"ngFor","ngForOf"],["for","regionId",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["class","absolute -right-4 text-red-500",4,"ngIf"],["id","agencia","formControlName","agencia","autocomplete","NA",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","agencia",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","text","name","nro_solicitud","id","nro_solicitud","placeholder","nro_solicitud","formControlName","nro_solicitud","autocomplete","NA",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","nro_solicitud",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","text","id","nivel_medida","placeholder","Buscar caedec...","name","nivel_medida","formControlName","nivel_medida","autocomplete","off",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"focus","blur","formControl","ngClass"],["for","nivel_medida",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["class","absolute z-20 mt-1 w-full bg-white border border-gray-300 rounded-lg shadow-lg","style","max-height: 200px; overflow-y: auto; top: calc(100% + 4px);",3,"mousedown",4,"ngIf"],["id","respaldo","formControlName","respaldo","autocomplete","NA",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","respaldo",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","number","name","monto_inv_mn","id","monto_inv_mn","placeholder","Monto de Credito(BS)","formControlName","monto_inv_mn","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["for","monto_inv_mn",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["type","number","name","tipo_cambio","id","tipo_cambio","placeholder","Tipo de Cambio","formControlName","tipo_cambio","autocomplete","NA","step","0.01","value","6.96",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["type","number","name","monto_inv_me","id","monto_inv_me","placeholder","Monto de Credito(USD)","formControlName","monto_inv_me","autocomplete","NA","step","0.01",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"ngClass"],["id","subcategoria","formControlName","subcategoria","autocomplete","NA",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"change","ngClass"],["for","subcategoria",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["id","tipo_tecnologia","formControlName","tipo_tecnologia","autocomplete","NA",1,"peer","mt-1","w-full","border-b-2","border-gray-300","px-2","py-1.5","bg-gray-100","placeholder:text-transparent","focus:border-gray-500","focus:outline-none","focus:bg-white","rounded-md","text-sm",3,"change","ngClass"],["for","tipo_tecnologia",1,"pointer-events-none","absolute","top-0","left-0","origin-left","-translate-y-1/2","transform","text-sm","text-gray-800","opacity-75","transition-all","duration-100","ease-in-out","peer-placeholder-shown:top-1/2","peer-placeholder-shown:text-base","peer-placeholder-shown:text-gray-500","peer-focus:top-0","peer-focus:pl-0","peer-focus:text-sm","peer-focus:text-gray-800"],["class","col-span-1 md:col-span-2 mt-1 flex items-center space-x-4",4,"ngIf"],[1,"p-1","bg-gray","rounded-lg","shadow-lg","border","border-gray-300","opacity-90"],[1,"text-gray-800","mb-4"],[1,"grid","grid-cols-7","gap-2"],[1,"flex","items-center","space-x-2"],["type","checkbox","id","image-check1","formControlName","fin_pobreza",1,"h-4","w-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500"],["src","assets/ods1.png","alt","Descripci\xF3n de la imagen",1,"h-12","w-12","object-cover","rounded-lg","shadow-lg","opacity-75"],["type","checkbox","id","image-check2","formControlName","hambre_cero",1,"h-4","w-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500"],["src","assets/ods2.png","alt","Descripci\xF3n de la imagen",1,"h-12","w-12","object-cover","rounded-lg","shadow-lg","opacity-75"],["type","checkbox","id","image-check3","formControlName","salud_bienestar",1,"h-4","w-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500"],["src","assets/ods3.png","alt","Descripci\xF3n de la imagen",1,"h-12","w-12","object-cover","rounded-lg","shadow-lg","opacity-75"],["type","checkbox","id","image-check4","formControlName","educacion_calidad",1,"h-4","w-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500"],["src","assets/ods4.png","alt","Descripci\xF3n de la imagen",1,"h-12","w-12","object-cover","rounded-lg","shadow-lg","opacity-75"],["type","checkbox","id","image-check5","formControlName","igualdad_genero",1,"h-4","w-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500"],["src","assets/ods5.png","alt","Descripci\xF3n de la imagen",1,"h-12","w-12","object-cover","rounded-lg","shadow-lg","opacity-75"],["type","checkbox","id","image-check6","formControlName","agua_limp_sanea",1,"h-4","w-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500"],["src","assets/ods6.png","alt","Descripci\xF3n de la imagen",1,"h-12","w-12","object-cover","rounded-lg","shadow-lg","opacity-75"],["type","checkbox","id","image-check7","formControlName","enr_ase_nocon",1,"h-4","w-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500"],["src","assets/ods7.png","alt","Descripci\xF3n de la imagen",1,"h-12","w-12","object-cover","rounded-lg","shadow-lg","opacity-75"],["type","checkbox","id","image-check8","formControlName","trab_dec_creeco",1,"h-4","w-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500"],["src","assets/ods8.png","alt","Descripci\xF3n de la imagen",1,"h-12","w-12","object-cover","rounded-lg","shadow-lg","opacity-75"],["type","checkbox","id","image-check9","formControlName","ind_ino_inf",1,"h-4","w-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500"],["src","assets/ods9.png","alt","Descripci\xF3n de la imagen",1,"h-12","w-12","object-cover","rounded-lg","shadow-lg","opacity-75"],["type","checkbox","id","image-check10","formControlName","reduc_desig",1,"h-4","w-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500"],["src","assets/ods10.png","alt","Descripci\xF3n de la imagen",1,"h-12","w-12","object-cover","rounded-lg","shadow-lg","opacity-75"],["type","checkbox","id","image-check11","formControlName","ciu_com_sos",1,"h-4","w-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500"],["src","assets/ods11.png","alt","Descripci\xF3n de la imagen",1,"h-12","w-12","object-cover","rounded-lg","shadow-lg","opacity-75"],["type","checkbox","id","image-check12","formControlName","prod_con_res",1,"h-4","w-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500"],["src","assets/ods12.png","alt","Descripci\xF3n de la imagen",1,"h-12","w-12","object-cover","rounded-lg","shadow-lg","opacity-75"],["type","checkbox","id","image-check13","formControlName","acc_por_cli",1,"h-4","w-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500"],["src","assets/ods13.png","alt","Descripci\xF3n de la imagen",1,"h-12","w-12","object-cover","rounded-lg","shadow-lg","opacity-75"],["type","checkbox","id","image-check14","formControlName","vida_sub",1,"h-4","w-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500"],["src","assets/ods14.png","alt","Descripci\xF3n de la imagen",1,"h-12","w-12","object-cover","rounded-lg","shadow-lg","opacity-75"],["type","checkbox","id","image-check15","formControlName","vida_eco_terr",1,"h-4","w-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500"],["src","assets/ods15.png","alt","Descripci\xF3n de la imagen",1,"h-12","w-12","object-cover","rounded-lg","shadow-lg","opacity-75"],["type","checkbox","id","image-check16","formControlName","paz_jus_instsol",1,"h-4","w-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500"],["src","assets/ods16.png","alt","Descripci\xF3n de la imagen",1,"h-12","w-12","object-cover","rounded-lg","shadow-lg","opacity-75"],["type","checkbox","id","image-check17","formControlName","ali_lograr_obj",1,"h-4","w-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500"],["src","assets/ods17.png","alt","Descripci\xF3n de la imagen",1,"h-12","w-12","object-cover","rounded-lg","shadow-lg","opacity-75"],[1,"my-5"],["type","submit",1,"text-white","bg-blue-600","hover:bg-blue-700","font-medium","rounded-lg","w-full","sm:w-auto","px-5","py-2.5","text-center"],["type","button",1,"text-white","ms-2","bg-gray-700","hover:bg-gray-800","font-medium","rounded-lg","w-full","sm:w-auto","px-5","py-2.5","text-center",3,"click"],[3,"closeModal","isOpen"],[3,"onCloseModalEbFv","dataOds","montoInvMe","MontoInvBS","regionId","agenciaId","nroSolicitud","caedecId","respaldo","subcategoriaId","inversionElegibleId"],[3,"onCloseModalEbSb","dataOds","montoInvMe","MontoInvBS","regionId","agenciaId","nroSolicitud","caedecId","respaldo","subcategoriaId","inversionElegibleId"],[3,"onCloseModalEbCa","dataOds","montoInvMe","MontoInvBS","regionId","agenciaId","nroSolicitud","caedecId","respaldo","subcategoriaId","inversionElegibleId"],[3,"value"],[1,"absolute","-right-4","text-red-500"],[1,"absolute","z-20","mt-1","w-full","bg-white","border","border-gray-300","rounded-lg","shadow-lg",2,"max-height","200px","overflow-y","auto","top","calc(100% + 4px)",3,"mousedown"],["class","p-2 border-b border-gray-200 cursor-pointer hover:bg-gray-100",3,"click",4,"ngFor","ngForOf"],[1,"p-2","border-b","border-gray-200","cursor-pointer","hover:bg-gray-100",3,"click"],[1,"col-span-1","md:col-span-2","mt-1","flex","items-center","space-x-4"],["alt","Imagen seleccionada",1,"w-32","h-32","md:w-48","md:h-48","object-cover",3,"src"],[1,"flex","flex-col","max-w-xs"],[1,"text-lg","mb-3"],[1,"font-bold"],[1,"text-lg","mb-2"],[1,"text-lg"]],template:function(n,e){if(n&1&&(i(0,"h5",0),r(1,"Ingresar datos"),o(),i(2,"form",1),b("ngSubmit",function(){return e.onSubmit()}),i(3,"div",2)(4,"div",3)(5,"select",4),b("change",function(c){return e.onRegionChange(c)}),i(6,"option",5),r(7,"Seleccione la region"),o(),u(8,Do,2,2,"option",6),o(),i(9,"label",7),r(10," Regi\xF3n "),o(),u(11,To,2,0,"div",8),o(),i(12,"div",3)(13,"select",9)(14,"option",5),r(15,"Seleccione la agencia"),o(),u(16,No,2,2,"option",6),o(),i(17,"label",10),r(18," Agencia "),o(),u(19,Bo,2,0,"div",8),o()(),i(20,"div",2)(21,"div",3),g(22,"input",11),i(23,"label",12),r(24," Nro solicitud"),o(),u(25,Oo,2,0,"div",8),o(),i(26,"div",3)(27,"input",13),b("focus",function(){return e.showDropdown=!0})("blur",function(){return e.hideDropdown()}),o(),i(28,"label",14),r(29," Buscar caedec..."),o(),u(30,qo,2,0,"div",8)(31,ko,2,1,"ul",15),o()(),i(32,"div",2)(33,"div",3)(34,"select",16),u(35,Vo,2,2,"option",6),o(),i(36,"label",17),r(37," Respaldo "),o(),u(38,Lo,2,0,"div",8),o(),i(39,"div",3),g(40,"input",18),i(41,"label",19),r(42,"Monto de Credito(BS)"),o(),u(43,Po,2,0,"div",8),o()(),i(44,"div",2)(45,"div",3),g(46,"input",20),i(47,"label",19),r(48,"Tipo de Cambio"),o(),u(49,Ro,2,0,"div",8),o(),i(50,"div",3),g(51,"input",21),i(52,"label",19),r(53,"Monto de Credito(USD)"),o(),u(54,Uo,2,0,"div",8),o()(),i(55,"div",2)(56,"div",3)(57,"select",22),b("change",function(c){return e.onSubcategoriaChange(c)}),i(58,"option",5),r(59,"Seleccione subcategor\xEDa"),o(),u(60,jo,2,2,"option",6),o(),i(61,"label",23),r(62," Subcategoria "),o(),u(63,Ho,2,0,"div",8),o(),i(64,"div",3)(65,"select",24),b("change",function(c){return e.onTipoTecnologiaChange(c)}),i(66,"option",5),r(67,"Seleccione tecnologia"),o(),u(68,Go,2,2,"option",6),o(),i(69,"label",25),r(70," Inversi\xF3n Elegible "),o(),u(71,Wo,2,0,"div",8),o(),u(72,$o,19,5,"div",26),o(),i(73,"div",27)(74,"h2",28),r(75,"Objetivos de Desarrollo Sostenible (ODS) a los que aporta"),o(),i(76,"div",29)(77,"div",30),g(78,"input",31)(79,"img",32),o(),i(80,"div",30),g(81,"input",33)(82,"img",34),o(),i(83,"div",30),g(84,"input",35)(85,"img",36),o(),i(86,"div",30),g(87,"input",37)(88,"img",38),o(),i(89,"div",30),g(90,"input",39)(91,"img",40),o(),i(92,"div",30),g(93,"input",41)(94,"img",42),o(),i(95,"div",30),g(96,"input",43)(97,"img",44),o(),i(98,"div",30),g(99,"input",45)(100,"img",46),o(),i(101,"div",30),g(102,"input",47)(103,"img",48),o(),i(104,"div",30),g(105,"input",49)(106,"img",50),o(),i(107,"div",30),g(108,"input",51)(109,"img",52),o(),i(110,"div",30),g(111,"input",53)(112,"img",54),o(),i(113,"div",30),g(114,"input",55)(115,"img",56),o(),i(116,"div",30),g(117,"input",57)(118,"img",58),o(),i(119,"div",30),g(120,"input",59)(121,"img",60),o(),i(122,"div",30),g(123,"input",61)(124,"img",62),o(),i(125,"div",30),g(126,"input",63)(127,"img",64),o()()(),i(128,"div",65)(129,"button",66),r(130,"Siguiente"),o(),i(131,"button",67),b("click",function(){return e.onClose()}),r(132,"Cancel"),o()()(),i(133,"app-modal",68),b("closeModal",function(){return e.closeModalEB_FV()}),i(134,"app-eb-fv",69),b("onCloseModalEbFv",function(){return e.closeModalEB_FV()}),o()(),i(135,"app-modal",68),b("closeModal",function(){return e.closeModalEB_SB()}),i(136,"app-eb-sb",70),b("onCloseModalEbSb",function(){return e.closeModalEB_SB()}),o()(),i(137,"app-modal",68),b("closeModal",function(){return e.closeModalEB_CA()}),i(138,"app-eb-ca",71),b("onCloseModalEbCa",function(){return e.closeModalEB_CA()}),o()()),n&2){let d,c,_,p,v,S,I,C,w,M,N,B,x,D,y,F,O,A,k,L;l(2),s("formGroup",e.dataForm),l(3),s("ngClass",h(62,X,((d=e.dataForm.get("regionId"))==null?null:d.hasError("required"))&&((d=e.dataForm.get("regionId"))==null?null:d.touched))),l(3),s("ngForOf",e.regionList),l(3),s("ngIf",((c=e.dataForm.get("regionId"))==null?null:c.hasError("required"))&&((c=e.dataForm.get("regionId"))==null?null:c.touched)),l(2),s("ngClass",h(64,X,((_=e.dataForm.get("agencia"))==null?null:_.hasError("required"))&&((_=e.dataForm.get("agencia"))==null?null:_.touched))),l(3),s("ngForOf",e.agenciaList),l(3),s("ngIf",((p=e.dataForm.get("agencia"))==null?null:p.hasError("required"))&&((p=e.dataForm.get("agencia"))==null?null:p.touched)),l(3),s("ngClass",h(66,X,((v=e.dataForm.get("nro_solicitud"))==null?null:v.hasError("required"))&&((v=e.dataForm.get("nro_solicitud"))==null?null:v.touched))),l(3),s("ngIf",((S=e.dataForm.get("nro_solicitud"))==null?null:S.hasError("required"))&&((S=e.dataForm.get("nro_solicitud"))==null?null:S.touched)),l(2),s("formControl",e.searchTermControl)("ngClass",h(68,X,((I=e.dataForm.get("nivel_medida"))==null?null:I.hasError("required"))&&((I=e.dataForm.get("nivel_medida"))==null?null:I.touched))),l(3),s("ngIf",((C=e.dataForm.get("nivel_medida"))==null?null:C.hasError("required"))&&((C=e.dataForm.get("nivel_medida"))==null?null:C.touched)),l(),s("ngIf",e.showDropdown&&e.filteredItems.length>0),l(3),s("ngClass",h(70,X,((w=e.dataForm.get("respaldo"))==null?null:w.hasError("required"))&&((w=e.dataForm.get("respaldo"))==null?null:w.touched))),l(),s("ngForOf",e.respaldoList),l(3),s("ngIf",((M=e.dataForm.get("respaldo"))==null?null:M.hasError("required"))&&((M=e.dataForm.get("respaldo"))==null?null:M.touched)),l(2),s("ngClass",h(72,X,((N=e.dataForm.get("monto_inv_mn"))==null?null:N.hasError("required"))&&((N=e.dataForm.get("monto_inv_mn"))==null?null:N.touched))),l(3),s("ngIf",((B=e.dataForm.get("monto_inv_mn"))==null?null:B.hasError("required"))&&((B=e.dataForm.get("monto_inv_mn"))==null?null:B.touched)),l(3),s("ngClass",h(74,X,((x=e.dataForm.get("tipo_cambio"))==null?null:x.hasError("required"))&&((x=e.dataForm.get("tipo_cambio"))==null?null:x.touched))),l(3),s("ngIf",((D=e.dataForm.get("tipo_cambio"))==null?null:D.hasError("required"))&&((D=e.dataForm.get("tipo_cambio"))==null?null:D.touched)),l(2),s("ngClass",h(76,X,((y=e.dataForm.get("monto_inv_me"))==null?null:y.hasError("required"))&&((y=e.dataForm.get("monto_inv_me"))==null?null:y.touched))),l(3),s("ngIf",((F=e.dataForm.get("monto_inv_me"))==null?null:F.hasError("required"))&&((F=e.dataForm.get("monto_inv_me"))==null?null:F.touched)),l(3),s("ngClass",h(78,X,((O=e.dataForm.get("subcategoria"))==null?null:O.hasError("required"))&&((O=e.dataForm.get("subcategoria"))==null?null:O.touched))),l(3),s("ngForOf",e.subcategoriaList),l(3),s("ngIf",((A=e.dataForm.get("subcategoria"))==null?null:A.hasError("required"))&&((A=e.dataForm.get("subcategoria"))==null?null:A.touched)),l(2),s("ngClass",h(80,X,((k=e.dataForm.get("tipo_tecnologia"))==null?null:k.hasError("required"))&&((k=e.dataForm.get("tipo_tecnologia"))==null?null:k.touched))),l(3),s("ngForOf",e.inversionElegibleList),l(3),s("ngIf",((L=e.dataForm.get("tipo_tecnologia"))==null?null:L.hasError("required"))&&((L=e.dataForm.get("tipo_tecnologia"))==null?null:L.touched)),l(),s("ngIf",e.selectedImage),l(61),s("isOpen",e.isModalEbFvOpen),l(),s("dataOds",e.ods)("montoInvMe",e.MontoInvUSD)("MontoInvBS",e.MontoInvBS)("regionId",e.regionId)("agenciaId",e.agenciaId)("nroSolicitud",e.nroSolicitud)("caedecId",e.caedecId)("respaldo",e.respaldo)("subcategoriaId",e.subcategoriaId)("inversionElegibleId",e.inversionElegibleId),l(),s("isOpen",e.isModalEbSbOpen),l(),s("dataOds",e.ods)("montoInvMe",e.MontoInvUSD)("MontoInvBS",e.MontoInvBS)("regionId",e.regionId)("agenciaId",e.agenciaId)("nroSolicitud",e.nroSolicitud)("caedecId",e.caedecId)("respaldo",e.respaldo)("subcategoriaId",e.subcategoriaId)("inversionElegibleId",e.inversionElegibleId),l(),s("isOpen",e.isModalEbCaOpen),l(),s("dataOds",e.ods)("montoInvMe",e.MontoInvUSD)("MontoInvBS",e.MontoInvBS)("regionId",e.regionId)("agenciaId",e.agenciaId)("nroSolicitud",e.nroSolicitud)("caedecId",e.caedecId)("respaldo",e.respaldo)("subcategoriaId",e.subcategoriaId)("inversionElegibleId",e.inversionElegibleId)}},dependencies:[H,te,fe,$,se,ie,be,ve,z,ne,pt,he,K,oe,_t,ae,re,je,Re,We,$e]})};function zo(a,t){if(a&1){let n=ue();i(0,"div",1),g(1,"pdf-viewer",2),i(2,"div",3)(3,"button",4),b("click",function(){J(n);let d=U();return Y(d.downloadPdf())}),r(4,"Descargar PDF"),o(),i(5,"button",4),b("click",function(){J(n);let d=U();return Y(d.closeModal())}),r(6,"Cerrar"),o()()()}if(a&2){let n=U();l(),s("src",n.pdfSrc)("render-text",!0)}}var Ke=class a{ecoeficienciaId=null;onCloseDocModal=new W;ecoServices=E(V);odsServices=E(de);datePipe=E(Je);pdfSrc=null;pdfBlobUrl=null;dataSet;dataSetOds=[];ngOnChanges(){console.log(this.ecoeficienciaId),this.ecoeficienciaId&&(this.getEcoeficienciaById(this.ecoeficienciaId),this.getOdsById(this.ecoeficienciaId))}getEcoeficienciaById(t){this.ecoServices.getEcoeficienciaById(t).subscribe({next:n=>{this.dataSet=n,console.log(this.dataSet),this.dataSet.fecha_registro_formatted=this.formatFechaRegistro(this.dataSet.fecha_registro),this.dataSet?(console.log("Datos recibidos:",this.dataSet),this.generatePdf()):console.log("No hay datos para generar el PDF")},error:n=>{console.error("Error al obtener ecoeficiencia:",n)}})}getOdsById(t){this.odsServices.getOds(t).subscribe({next:n=>{this.dataSetOds=n.map(e=>({imagen:e.imagen,descripcion:e.descripcion})),console.log(this.dataSetOds)},error:n=>{console.error("Error al obtener ods:",n)}})}formatFechaRegistro(t){if(!t)return null;let n=new Date(t);return this.datePipe.transform(n,"dd/MM/yyyy")}generatePdf(){if(!this.dataSet)return;let t=new Lt({orientation:"p",unit:"mm",format:[210,297]}),n="assets/bdp.png",e=new Image;e.src=n,Promise.all([new Promise(d=>{e.onload=d})]).then(()=>{t.addImage(e,"PNG",165,6,20,20),t.setFontSize(10);let d=["Formulaci\xF3n de Validaci\xF3n de Proyectos","Medida Est\xE1ndar en Bolivia","Reporte Final"],c=10,_=t.internal.pageSize.getWidth();d.forEach((x,D)=>{let y=t.getTextWidth(x),F=(_-y)/2,O=5+D*5;t.text(x,F,O+6),t.setFont("Helvetica","bold")}),t.setFont("Helvetica","normal");let p=30;t.setFont("Helvetica","bold"),t.text("1 Informaci\xF3n General",c,p),t.setFont("Helvetica","normal"),p+=3,[{label:"Insttuci\xF3n Financiera:",value:"Banco de Desarrollo Productivo S.A.M."},{label:"Regi\xF3n:",value:this.dataSet?.region.nombreRegion},{label:"Agencia:",value:this.dataSet?.agencium?.nombreAgencia},{label:"Analista:",value:this.dataSet?.usuario?.nombre_completo},{label:"Fecha de Reporte:",value:this.dataSet.fecha_registro_formatted}].forEach(x=>{let y=(_-2*c)/2,F=(_-2*c)/2;t.rect(c,p,y,6),t.rect(c+y,p,F,6),t.text(x.label,c+2,p+5);let O=(x.value??"n/a").toString(),A=t.getTextWidth(O),k=c+y+(F-A)/2;t.text(O,k,p+5),p+=6}),p+=10,t.setFont("Helvetica","bold"),t.text("2 Informaci\xF3n del Cliente",c,p),t.setFont("Helvetica","normal"),p+=3,[{label:"Caedec - C\xF3digo Subcteg :",value:this.dataSet?.caedec?.actividad},{label:"Caedec - Descripcion Subcteg :",value:this.dataSet?.caedec?.nombreCaedec},{label:"Nro Solicitud:",value:this.dataSet?.nro_solicitud}].forEach(x=>{let y=(_-2*c)/2,F=(_-2*c)/2,O=(x.value??"n/a").toString(),A=t.splitTextToSize(O,F),L=6*A.length;t.rect(c,p,y,L),t.rect(c+y,p,F,L),t.text(x.label,c+2,p+5);let pe=c+y+2;A.forEach((ge,_e)=>{t.text(ge,pe,p+5+_e*4)}),p+=L}),p+=10,t.setFont("Helvetica","bold"),t.text("4 Informaci\xF3n del Proyecto",c,p),t.setFont("Helvetica","normal"),p+=3;let I=[{label:"Respaldo de  inversion elegible",value:this.dataSet?.respaldo},{label:"Categoria:",value:this.dataSet?.inv_elegible.categoria},{label:"Subcategoria:",value:this.dataSet?.subcategorium.nombreSubcategoria},{label:"Inversi\xF3n Elegible:",value:this.dataSet?.inv_elegible.nombreInvElegible}];(this.dataSet?.inv_elegible.nombreInvElegible==="Paneles solares (on grid)"||this.dataSet?.inv_elegible.nombreInvElegible==="Paneles solares (off grid)")&&I.push({label:"Potencia instalada del sistema (KWp):",value:this.dataSet?.potencia_inst_sis}),I.push({label:"Producci\xF3n Energia Anual (MWh/a\xF1o):",value:this.formatNumero(this.dataSet?.produccion_energia_anual/1e3)},{label:"Reducci\xF3n Emisiones Anual (t CO2eq/a\xF1o):",value:this.formatNumero(this.dataSet?.reduccion_emisiones_anual/1e3)},{label:"Vida \xFAtil de la tecnolog\xEDa (a\xF1os):",value:this.dataSet?.vida_util},{label:"Monto de cr\xE9dito (Bs):",value:this.formatNumero(this.dataSet?.monto_inv_mn)}),I.forEach(x=>{let y=(_-2*c)/2,F=(_-2*c)/2;t.rect(c,p,y,6),t.rect(c+y,p,F,6),t.text(x.label,c+2,p+5);let O=(x.value??"n/a").toString(),A=t.getTextWidth(O),k=c+y+(F-A)/2;t.text(O,k,p+5),p+=6}),p+=10,t.setFontSize(10),t.setFont("Helvetica","bold"),t.text("Objetivos de Desarrollo Sostenible (ODS) a los que aporta :",c,p),p+=5;let C=10,w=10,M=2,N=Math.max(w,10);this.dataSetOds.forEach((x,D)=>{let y=c+D%3*(C+M+55),F=Math.floor(D/3)*(N+1);t.addImage(x.imagen,"PNG",y,p+F,C,w),t.setFontSize(8),t.setFont("Helvetica","normal");let O=y+C+1;t.text(x.descripcion,O,p+F+w/2)});let B=t.output("blob");this.pdfBlobUrl&&URL.revokeObjectURL(this.pdfBlobUrl),this.pdfBlobUrl=URL.createObjectURL(B),this.pdfSrc=this.pdfBlobUrl})}downloadPdf(){if(this.pdfBlobUrl){let t=document.createElement("a");t.href=this.pdfBlobUrl,t.download="reporte-ecoeficiencia.pdf",t.click()}}closeModal(){this.onCloseDocModal.emit(),this.dataSet=null}ngOnDestroy(){this.pdfBlobUrl&&URL.revokeObjectURL(this.pdfBlobUrl)}formatNumero(t){if(t===null)return"n/a";let n=t.toString().split("."),e=n[0].replace(/\B(?=(\d{3})+(?!\d))/g,"."),d=n[1]?","+n[1]:"";return e+d}static \u0275fac=function(n){return new(n||a)};static \u0275cmp=R({type:a,selectors:[["app-inicio-datos-reporte-eco"]],inputs:{ecoeficienciaId:"ecoeficienciaId"},outputs:{onCloseDocModal:"onCloseDocModal"},standalone:!0,features:[ct([Je]),G,j],decls:1,vars:1,consts:[["class","pdf-container",4,"ngIf"],[1,"pdf-container"],[2,"display","block","width","100%","height","100%",3,"src","render-text"],[1,"pdf-controls"],[3,"click"]],template:function(n,e){n&1&&u(0,zo,7,2,"div",0),n&2&&s("ngIf",e.pdfSrc)},dependencies:[Rt,Pt,H,$],styles:['@charset "UTF-8";.pdf-container[_ngcontent-%COMP%]{width:800px;height:800px;overflow:auto;position:relative}pdf-viewer[_ngcontent-%COMP%]{width:80%;height:80%;background:#fff;border:1px solid #ccc}.pdf-controls[_ngcontent-%COMP%]{position:absolute;bottom:10px;right:10px;display:flex;gap:10px}.pdf-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 20px;font-size:16px;color:#fff;background-color:#007bff;border:none;border-radius:5px;cursor:pointer}.pdf-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#0056b3}']})};var Ko=()=>[5,10,25,100];function Qo(a,t){a&1&&(i(0,"th",29),r(1," Id "),o())}function Xo(a,t){if(a&1&&(i(0,"td",30),r(1),o()),a&2){let n=t.$implicit;l(),T(" ",n.id," ")}}function Jo(a,t){a&1&&(i(0,"th",29),r(1," Nro Solicitud "),o())}function Yo(a,t){if(a&1&&(i(0,"td",30),r(1),o()),a&2){let n=t.$implicit;l(),T(" ",n.nro_solicitud," ")}}function Zo(a,t){a&1&&(i(0,"th",29),r(1," Respaldo "),o())}function ei(a,t){if(a&1&&(i(0,"td",30),r(1),o()),a&2){let n=t.$implicit;l(),T(" ",n.respaldo," ")}}function ti(a,t){a&1&&(i(0,"th",29),r(1," Monto inv(USD) "),o())}function oi(a,t){if(a&1&&(i(0,"td",30),r(1),o()),a&2){let n=t.$implicit;l(),T(" ",n.monto_inv_me," ")}}function ii(a,t){a&1&&(i(0,"th",29),r(1," Produccion Energia Anual "),o())}function ni(a,t){if(a&1&&(i(0,"td",30),r(1),o()),a&2){let n=t.$implicit;l(),T(" ",n.produccion_energia_anual," ")}}function ai(a,t){a&1&&(i(0,"th",29),r(1," Reduccion Emisiones Anual "),o())}function ri(a,t){if(a&1&&(i(0,"td",30),r(1),o()),a&2){let n=t.$implicit;l(),T(" ",n.reduccion_emisiones_anual," ")}}function li(a,t){a&1&&(i(0,"th",29),r(1," Opciones "),o())}function si(a,t){if(a&1){let n=ue();i(0,"td",30)(1,"div",31)(2,"div",32)(3,"button",33),b("click",function(){let d=J(n).$implicit,c=U();return Y(c.openModalDoc(d.id))}),i(4,"i",34),Qe(),i(5,"svg",35),g(6,"path",36)(7,"polyline",37),o(),Xe(),i(8,"span",38),r(9," Ver Doc. "),o()()()(),i(10,"div",39)(11,"button",40),b("click",function(){let d=J(n).$implicit,c=U();return Y(c.deleteEcoeficiencia(d.id))}),i(12,"i",34),Qe(),i(13,"svg",41),g(14,"path",42)(15,"line",43)(16,"line",44)(17,"line",45)(18,"path",46)(19,"path",47),o(),Xe(),i(20,"span",38),r(21," Eliminar "),o()()()()()()}}function di(a,t){a&1&&g(0,"tr",48)}function ci(a,t){a&1&&g(0,"tr",49)}var Ze=class a{Ecoeficiencia;ecoeficienciaId;isModalOpen=!1;ecoService=E(V);ecoeficiencias=Pe([]);displayedColumns=["id","nro_solicitud","respaldo","monto_inv_me","produccion_energia_anual","reduccion_emisiones_anual","actions"];dataSource=new Tt([]);paginator;filterId="";toastr=E(Q);isModalDocOpen=!1;ngOnInit(){this.getEcoeficiencia()}ngAfterViewInit(){this.dataSource.paginator=this.paginator}getEcoeficiencia(){this.ecoService.getEcoeficiencia().subscribe({next:t=>{this.ecoeficiencias.set(t),this.dataSource.data=t,this.applyFilter()},error:()=>{this.toastr.error("Error al cargar los datos")}})}applyFilter(){this.dataSource.filterPredicate=(t,n)=>{let[e]=n.trim().split(";");return e?t.id.toString().toLowerCase().includes(e):!0}}openModal(){this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.getEcoeficiencia()}openModalDoc(t){this.ecoeficienciaId=t,this.isModalDocOpen=!0}closeModalDoc(){this.isModalDocOpen=!1}deleteEcoeficiencia(t){this.ecoService.eliminaEcoeficiencia(t).subscribe({next:()=>{this.toastr.success("Registro de Ecoeficiencia Eliminado"),this.getEcoeficiencia()}})}static \u0275fac=function(n){return new(n||a)};static \u0275cmp=R({type:a,selectors:[["app-inicio-datos"]],viewQuery:function(n,e){if(n&1&&nt(Ue,5),n&2){let d;at(d=rt())&&(e.paginator=d.first)}},standalone:!0,features:[j],decls:44,vars:10,consts:[[1,"py-1"],[1,"mx-auto","sm:px-6","lg:px-8","mb-6"],[1,"mx-4","pb-6","text-3xl","font-bold","text-gray-800"],[1,"border-t-4","border-t-indigo-500","-mt-4","ml-5","w-64"],[1,"mx-auto","sm:px-6","lg:px-8"],[1,"bg-white","overflow-hidden","shadow-xl","sm:rounded-lg","px-4","py-4","dark:bg-gray-800/50","dark:bg-gradient-to-bl"],[1,"flex","items-center","justify-between","dark:text-gray-400","m-4"],[1,"space-x-8","mb-2"],["type","button",1,"focus:ring-2","focus:ring-offset-2","focus:ring-blue-600","mt-4","sm:mt-0","inline-flex","items-start","justify-start","px-6","py-3","bg-blue-500","hover:bg-blue-600","focus:outline-none","rounded",3,"click"],[1,"text-sm","font-medium","leading-none","text-white"],[1,"flex","space-x-4"],["matInput","","placeholder","Filtro por ID",3,"ngModelChange","ngModel"],[1,"shadow","overflow-hidden","border-b","border-gray-200","sm:rounded-lg"],["mat-table","",1,"no-border-table","w-full","divide-y","divide-gray-200","table-auto",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","nro_solicitud"],["matColumnDef","respaldo"],["matColumnDef","monto_inv_me"],["matColumnDef","produccion_energia_anual"],["matColumnDef","reduccion_emisiones_anual"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],[3,"closeModal","isOpen"],[3,"onCloseModal","data"],[3,"onCloseDocModal","ecoeficienciaId"],["mat-header-cell",""],["mat-cell",""],[1,"flex","items-center","space-x-2"],[1,"group","relative","inline-block","whitespace-nowrap"],[1,"bg-stone-700","w-8","h-8","rounded-full","hover:bg-stone-500","flex","items-center","justify-center","ml-2",3,"click"],[1,"text-white"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"h-5","w-5","text-white-500"],["d","M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"],["points","13 2 13 9 20 9"],["role","tooltip",1,"pointer-events-none","absolute","z-50","inline-flex","items-center","justify-center","rounded-md","px-3","py-1","font-semibold","opacity-0","transition-opacity","duration-300","ease-in-out","group-hover:opacity-100","bg-stone-50","text-stone-700","min-h-7","text-sm","left-1/2","-translate-x-1/2","after:absolute","after:block","after:size-0","after:border-8","after:border-transparent","after:border-t-stone-50","after:-bottom-[0.95rem]","after:left-1/2","after:-translate-x-1/2","top-[-2.5rem]"],[1,"group","relative"],[1,"bg-red-600","w-8","h-8","rounded-full","hover:bg-red-400","flex","items-center","justify-center",3,"click"],["width","4","height","4","viewBox","0 0 24 24","stroke-width","2","stroke","currentColor","fill","none","stroke-linecap","round","stroke-linejoin","round",1,"h-5","w-5","text-white-500"],["stroke","none","d","M0 0h24v24H0z"],["x1","4","y1","7","x2","20","y2","7"],["x1","10","y1","11","x2","10","y2","17"],["x1","14","y1","11","x2","14","y2","17"],["d","M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"],["d","M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"],["mat-header-row",""],["mat-row",""]],template:function(n,e){n&1&&(i(0,"div",0)(1,"div",1)(2,"h2",2),r(3," Inicio y Proceso de Datos "),o(),g(4,"div",3),o(),i(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7)(9,"button",8),b("click",function(){return e.openModal()}),i(10,"p",9),r(11," Iniciar"),o()()(),i(12,"div",10)(13,"input",11),dt("ngModelChange",function(c){return st(e.filterId,c)||(e.filterId=c),c}),b("ngModelChange",function(){return e.applyFilter()}),o()()(),i(14,"div",12)(15,"table",13),Z(16,14),u(17,Qo,2,0,"th",15)(18,Xo,2,1,"td",16),ee(),Z(19,17),u(20,Jo,2,0,"th",15)(21,Yo,2,1,"td",16),ee(),Z(22,18),u(23,Zo,2,0,"th",15)(24,ei,2,1,"td",16),ee(),Z(25,19),u(26,ti,2,0,"th",15)(27,oi,2,1,"td",16),ee(),Z(28,20),u(29,ii,2,0,"th",15)(30,ni,2,1,"td",16),ee(),Z(31,21),u(32,ai,2,0,"th",15)(33,ri,2,1,"td",16),ee(),Z(34,22),u(35,li,2,0,"th",15)(36,si,22,0,"td",16),ee(),u(37,di,1,0,"tr",23)(38,ci,1,0,"tr",24),o(),g(39,"mat-paginator",25),o()()()(),i(40,"app-modal",26),b("closeModal",function(){return e.closeModal()}),i(41,"app-inicio-datos-create",27),b("onCloseModal",function(){return e.closeModal()}),o()(),i(42,"app-modal",26),b("closeModal",function(){return e.closeModalDoc()}),i(43,"app-inicio-datos-reporte-eco",28),b("onCloseDocModal",function(){return e.closeModalDoc()}),o()()),n&2&&(l(13),lt("ngModel",e.filterId),l(2),s("dataSource",e.dataSource),l(22),s("matHeaderRowDef",e.displayedColumns),l(),s("matRowDefColumns",e.displayedColumns),l(),s("pageSizeOptions",mt(9,Ko)),l(),s("isOpen",e.isModalOpen),l(),s("data",e.Ecoeficiencia),l(),s("isOpen",e.isModalDocOpen),l(),s("ecoeficienciaId",e.ecoeficienciaId))},dependencies:[ze,Re,H,ft,z,K,gt,Nt,Ue,Dt,vt,Ct,Ft,yt,Et,It,St,xt,wt,Mt,Ot,Bt,Ke]})};export{Ze as default};
