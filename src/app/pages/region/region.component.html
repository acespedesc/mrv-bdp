<div>
    <div class="mx-auto sm:px-6 lg:px-8 mb-6">
        <h2 class="mx-4 pb-6 text-3xl font-bold text-gray-800">
            Regiones
        </h2>
        <div class="border-t-4 border-t-indigo-500 -mt-4 ml-5 w-36"></div>
    </div>
    <div class="mx-auto sm:px-6 lg:px-8">
        <div
            class="bg-white overflow-hidden shadow-xl sm:rounded-lg px-4 py-4 dark:bg-gray-800/50 dark:bg-gradient-to-bl">
            <div class="flex items-center justify-between dark:text-gray-400 mb-4">
                <div class="space-x-8">
                    <button type="button" (click)="openModal()"
                        class="focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 mt-4 sm:mt-0 inline-flex items-start justify-start px-6 py-3 bg-blue-600 hover:bg-blue-800 focus:outline-none rounded">
                        <p class="text-sm font-medium leading-none text-white">Add Region</p>
                    </button>
                </div>

            </div>
            <div class="shadow overflow-hidden border-b border-gray-200 sm:rounded-lg">
                <table mat-table [dataSource]="dataSource"
                    class="no-border-table w-full divide-y divide-gray-200 table-auto">

                    <ng-container matColumnDef="id">
                        <th mat-header-cell *matHeaderCellDef> Id </th>
                        <td mat-cell *matCellDef="let region"> {{ region.id}} </td>
                    </ng-container>

                    <ng-container matColumnDef="nombre">
                        <th mat-header-cell *matHeaderCellDef> Nombre </th>
                        <td mat-cell *matCellDef="let region"> {{ region.nombre}} </td>
                    </ng-container>

                    <ng-container matColumnDef="actions">
                        <th mat-header-cell *matHeaderCellDef> Opciones </th>
                        <td mat-cell *matCellDef="let region">
                            <div class="flex items-center space-x-2">
                                <div class="relative group">
                                    <button (click)="loadRegion(region)"
                                        class="bg-gray-700 w-8 h-8 rounded-full hover:bg-gray-400 flex items-center justify-center">
                                        <i class="fas fa-edit text-white">
                                            <svg class="h-5 w-5 text-white-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                                            </svg>
                                        </i>
                                    </button>
                                    <span role="tooltip"
                                        class="pointer-events-none absolute z-50 inline-flex items-center justify-center rounded-md px-3 py-1 font-semibold opacity-0 transition-opacity duration-300 ease-in-out group-hover:opacity-100 bg-stone-50 text-stone-700 min-h-7 text-sm left-1/2 -translate-x-1/2 after:absolute after:block after:size-0 after:border-8 after:border-transparent after:border-t-stone-50 after:-bottom-[0.95rem] after:left-1/2 after:-translate-x-1/2 top-[-2.5rem]">
                                        Editar
                                    </span>
                                </div>
                    
                                <div class="relative group">
                                    <button (click)="deleteRegion(region.id)"
                                        class="bg-red-600 w-8 h-8 rounded-full hover:bg-red-400 flex items-center justify-center">
                                        <i class="text-white">
                                            <svg class="h-5 w-5 text-white-500" width="4" height="4" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                <path stroke="none" d="M0 0h24v24H0z" />
                                                <line x1="4" y1="7" x2="20" y2="7" />
                                                <line x1="10" y1="11" x2="10" y2="17" />
                                                <line x1="14" y1="11" x2="14" y2="17" />
                                                <path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" />
                                                <path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" />
                                            </svg>
                                        </i>
                                    </button>
                                    <span role="tooltip"
                                        class="pointer-events-none absolute z-50 inline-flex items-center justify-center rounded-md px-3 py-1 font-semibold opacity-0 transition-opacity duration-300 ease-in-out group-hover:opacity-100 bg-stone-50 text-stone-700 min-h-7 text-sm left-1/2 -translate-x-1/2 after:absolute after:block after:size-0 after:border-8 after:border-transparent after:border-t-stone-50 after:-bottom-[0.95rem] after:left-1/2 after:-translate-x-1/2 top-[-2.5rem]">
                                        Eliminar
                                    </span>
                                </div>
                    
                                <div class="relative group">
                                    <button (click)="openModalAgencia(region.id, region.nombre)"
                                        class="bg-gray-700 w-8 h-8 rounded-full hover:bg-gray-500 flex items-center justify-center ml-2">
                                        <i class="text-white">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5m8.25 3v6.75m0 0-3-3m3 3 3-3M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z" />
                                            </svg>
                                        </i>
                                    </button>
                                    <span role="tooltip"
                                        class="pointer-events-none absolute z-50 inline-flex items-center justify-center rounded-md px-3 py-1 font-semibold opacity-0 transition-opacity duration-300 ease-in-out group-hover:opacity-100 bg-stone-50 text-stone-700 min-h-7 text-sm left-1/2 -translate-x-1/2 after:absolute after:block after:size-0 after:border-8 after:border-transparent after:border-t-stone-50 after:-bottom-[0.95rem] after:left-1/2 after:-translate-x-1/2 top-[-2.5rem]">
                                        Agencias
                                    </span>
                                </div>
                            </div>
                        </td>
                    </ng-container>
                    <!-- Fila de cabecera -->
                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <!-- Fila de datos -->
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                </table>
                <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" showFirstLastButtons></mat-paginator>
            </div>

        </div>

    </div>
</div>

<app-modal [isOpen]="isModalOpen" (closeModal)="closeModal()">
    <app-region-create (onCloseModal)="closeModal()" [data]="Region"></app-region-create>
</app-modal>
<app-modal [isOpen]="isModalAgenciaOpen" (closeModal)="closeModalAgencia()">
    <app-agencia (onCloseModalAgencia)="closeModalAgencia()" [regionId]="selectedRegionId" [nomRegion]="selectedNombreReg" ></app-agencia>>
</app-modal>